<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Testing HashiCorp Terraform | hashistack</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hashistack.org/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hashistack.org/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hashistack.org/blog/testing-hashicorp-terraform"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Testing HashiCorp Terraform | hashistack"><meta data-rh="true" name="description" content="How do we know if we can run terraform apply to our infrastructure without negatively affecting critical business"><meta data-rh="true" property="og:description" content="How do we know if we can run terraform apply to our infrastructure without negatively affecting critical business"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-09-05T09:21:27.000Z"><meta data-rh="true" property="article:author" content="https://www.hashicorp.com/blog/testing-hashicorp-terraform"><meta data-rh="true" property="article:tag" content="HashiCorp,Terraform"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hashistack.org/blog/testing-hashicorp-terraform"><link data-rh="true" rel="alternate" href="https://hashistack.org/blog/testing-hashicorp-terraform" hreflang="en"><link data-rh="true" rel="alternate" href="https://hashistack.org/blog/testing-hashicorp-terraform" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="hashistack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="hashistack Atom Feed"><link rel="stylesheet" href="/assets/css/styles.8cbc6638.css">
<script src="/assets/js/runtime~main.1a12f02f.js" defer="defer"></script>
<script src="/assets/js/main.2a38e368.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_yKSN" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Site Logo" class="themedComponent_XYAp themedComponent--light_He6m"><img src="/img/logo.svg" alt="Site Logo" class="themedComponent_XYAp themedComponent--dark_o9Gp"></div><b class="navbar__title text--truncate">hashistack</b></a><a class="navbar__item navbar__link" href="/docs/intro">Documentations</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/QubitPi/hashistack" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_LPLX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_AYYA colorModeToggle_FCpE"><button class="clean-btn toggleButton_Pn3z toggleButtonDisabled__CiM" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_cWiR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_OtLr"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_ASjm"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_vRC3"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_ayXN thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_XZG4 margin-bottom--md">Recent posts</div><ul class="sidebarItemList_KVGE clean-list"><li class="sidebarItem_nX9N"><a aria-current="page" class="sidebarItemLink_TiK_ sidebarItemLinkActive_ds8L" href="/blog/testing-hashicorp-terraform">Testing HashiCorp Terraform</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/version-bump">Bumping Semantic Version by GitHub Tag</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/cypress-e2e">Cypress E2E Tests</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/jdk-setup">Setting up JDK in GitHub Actions</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/npm-release">NPM Release action</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/ui-unit-test">UI Unit Test</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/ui-code-style">UI Code Style</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/yml-and-md-style-checks">Performing Style Check on YAML &amp; Markdown Files and Link Check</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/github-secret-action">Reusable GitHub Action - Posting GitHub Secrets</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/github-slack-notification">Sending GitHub Action Results to Slack Channel</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/github-matrix">Using a GitHub Action Matrix to Define Variations for Each Job</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/openssl-encrypt">Using OpenSSL to encrypt messages and files on Linux</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/dockerhub-github-actions">Build and Push Docker Images through GitHub Action</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/nvm">Switching Node.js Versions with NVM</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/jenkins-on-aws">Deploying Jenkins to AWS</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/aws-troubleshooting">AWS Troubleshooting</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/aws-iam">AWS Identity and Access Management (IAM)</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/nexus">Nexus 3 Repository Manager OSS</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/continuous-delivery">Continuous Delivery</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/deploying-vs-releasing">Deploying v.s. Releasing</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/docker-c-advisor">Docker cAdvisor</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/yahoo-object-storage">Yahoo Cloud Object Store - Object Storage at Exabyte Scale</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/ssh-ascii-banner">Add Custom ASCII Banner Logo to SSH Login Screen</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/trunk-based-deployment">Trunk-Based Development</a></li><li class="sidebarItem_nX9N"><a class="sidebarItemLink_TiK_" href="/blog/aws-s3-concepts">Amazon S3 concepts</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="How do we know if we can run terraform apply to our infrastructure without negatively affecting critical business"><header><h1 class="title_LEYg" itemprop="headline">Testing HashiCorp Terraform</h1><div class="container_QRFK margin-vert--md"><time datetime="2024-09-05T09:21:27.000Z" itemprop="datePublished">September 5, 2024</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_jSx2"><div class="avatar margin-bottom--sm"><a href="https://www.hashicorp.com/blog/testing-hashicorp-terraform" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://www.hashicorp.com/_next/static/media/terraform_on-dark.8e9a65a1.svg" alt="ROSEMARY WANG" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.hashicorp.com/blog/testing-hashicorp-terraform" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">ROSEMARY WANG</span></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>How do we know if we can run <code>terraform apply</code> to our infrastructure without negatively affecting critical business
applications? We can run <code>terraform validate</code> and <code>terraform plan</code> to check our configuration, but will that be enough?
Whether we&#x27;ve updated some HashiCorp Terraform configuration or a new version of a module, we want to catch errors
quickly before we apply any changes to production infrastructure.</p>
<p>In this post, We will discuss some testing strategies for HashiCorp Terraform configuration and modules so that we can
<code>terraform apply</code> with greater confidence.</p>
<h2 class="anchor anchorWithStickyNavbar_G07S" id="the-testing-pyramid">The Testing Pyramid<a href="#the-testing-pyramid" class="hash-link" aria-label="Direct link to The Testing Pyramid" title="Direct link to The Testing Pyramid">​</a></h2>
<p>In theory, we might decide to align our infrastructure testing strategy with the test pyramid, which groups tests by
type, scope, and granularity. The testing pyramid suggests that we write fewer tests in the categories at the top of the
pyramid, and more at the bottom. Those on the pyramid take more time to run and cost more due to the higher number of
resources we have to configure and create.</p>
<p><img loading="lazy" alt="Error loading pyramid.png" src="/assets/images/pyramid-c61e3ecc738268f3a07cbcf4faeea8a5.png" width="3840" height="2470" class="img_06Bp"></p>
<p>In reality, our tests may not perfectly align with the pyramid shape. The pyramid offers a common framework to describe
what scope a test can cover to verify configuration and infrastructure resources. We&#x27;ll start at the bottom of the
pyramid with unit tests and work the way up the pyramid to end-to-end tests.</p>
<div class="theme-admonition theme-admonition-note admonition_ti4u alert alert--secondary"><div class="admonitionHeading_HhbD"><span class="admonitionIcon_EB9A"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_SnZd"><p>hashicorp-aws does not merit any manual testing; so it is not discussed here</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_G07S" id="linting-and-formatting">Linting and Formatting<a href="#linting-and-formatting" class="hash-link" aria-label="Direct link to Linting and Formatting" title="Direct link to Linting and Formatting">​</a></h2>
<p>While not on the test pyramid, we often encounter tests to verify the hygiene of your Terraform configuration. Use
<code>terraform fmt -check</code> and terraform validate to format and validate the correctness of our Terraform configuration.</p>
<p>When we collaborate on Terraform, we may consider testing the Terraform configuration for a set of standards and best
practices. Build or use a linting tool to analyze our Terraform configuration for specific best practices and patterns.
For example, a linter can verify that our teammate defines a Terraform variable for an instance type instead of
hard-coding the value.</p>
<h2 class="anchor anchorWithStickyNavbar_G07S" id="unit-tests">Unit Tests<a href="#unit-tests" class="hash-link" aria-label="Direct link to Unit Tests" title="Direct link to Unit Tests">​</a></h2>
<p>At the bottom of the pyramid, unit tests verify individual resources and configurations for expected values. They should
answer the question, “Does my configuration or plan contain the correct metadata?” Traditionally, unit tests should run
independently, without external resources or API calls.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_D2YB"><div class="col"><b>Tags:</b><ul class="tags_IH5Z padding--none margin-left--sm"><li class="tag_otd8"><a class="tag_schK tagRegular_TuNl" href="/blog/tags/hashi-corp">HashiCorp</a></li><li class="tag_otd8"><a class="tag_schK tagRegular_TuNl" href="/blog/tags/terraform">Terraform</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/QubitPi/hashistack/tree/master/docs/blog/testing-hashicorp-terraform/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_e7Z8" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/version-bump"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Bumping Semantic Version by GitHub Tag</div></a></nav></main><div class="col col--2"><div class="tableOfContents_dgZx thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-testing-pyramid" class="table-of-contents__link toc-highlight">The Testing Pyramid</a></li><li><a href="#linting-and-formatting" class="table-of-contents__link toc-highlight">Linting and Formatting</a></li><li><a href="#unit-tests" class="table-of-contents__link toc-highlight">Unit Tests</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Documentations</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/hashistack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_LPLX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/QubitPi/hashistack" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_LPLX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Jiaqi Liu. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>