<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Deploying Jenkins to AWS | hashicorp-aws</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hashicorp-aws.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hashicorp-aws.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hashicorp-aws.com/blog/jenkins-on-aws"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Deploying Jenkins to AWS | hashicorp-aws"><meta data-rh="true" name="description" content="[//]: # (Copyright Jiaqi Liu)"><meta data-rh="true" property="og:description" content="[//]: # (Copyright Jiaqi Liu)"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-10-31T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/QubitPi"><meta data-rh="true" property="article:tag" content="Jenkins"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hashicorp-aws.com/blog/jenkins-on-aws"><link data-rh="true" rel="alternate" href="https://hashicorp-aws.com/blog/jenkins-on-aws" hreflang="en"><link data-rh="true" rel="alternate" href="https://hashicorp-aws.com/blog/jenkins-on-aws" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="hashicorp-aws RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="hashicorp-aws Atom Feed"><link rel="stylesheet" href="/assets/css/styles.bc7f6e16.css">
<script src="/assets/js/runtime~main.dc27c980.js" defer="defer"></script>
<script src="/assets/js/main.06eb71e6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">hashicorp-aws</b></a><a class="navbar__item navbar__link" href="/docs/intro">Documentations</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/QubitPi/hashicorp-aws" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/testing-hashicorp-terraform">Testing HashiCorp Terraform</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/version-bump">Bumping Semantic Version by GitHub Tag</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cypress-e2e">Cypress E2E Tests</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/jdk-setup">Setting up JDK in GitHub Actions</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/npm-release">NPM Release action</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ui-unit-test">UI Unit Test</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ui-code-style">UI Code Style</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/yml-and-md-style-checks">Performing Style Check on YAML &amp; Markdown Files and Link Check</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/github-secret-action">Reusable GitHub Action - Posting GitHub Secrets</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/github-slack-notification">Sending GitHub Action Results to Slack Channel</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/github-matrix">Using a GitHub Action Matrix to Define Variations for Each Job</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/openssl-encrypt">Using OpenSSL to encrypt messages and files on Linux</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/dockerhub-github-actions">Build and Push Docker Images through GitHub Action</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/nvm">Switching Node.js Versions with NVM</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/jenkins-on-aws">Deploying Jenkins to AWS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/aws-troubleshooting">AWS Troubleshooting</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/aws-iam">AWS Identity and Access Management (IAM)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/nexus">Nexus 3 Repository Manager OSS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/continuous-delivery">Continuous Delivery</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/deploying-vs-releasing">Deploying v.s. Releasing</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/docker-c-advisor">Docker cAdvisor</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/yahoo-object-storage">Yahoo Cloud Object Store - Object Storage at Exabyte Scale</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ssh-ascii-banner">Add Custom ASCII Banner Logo to SSH Login Screen</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/trunk-based-deployment">Trunk-Based Development</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/aws-s3-concepts">Amazon S3 concepts</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="[//]: # (Copyright Jiaqi Liu)"><header><h1 class="title_f1Hy" itemprop="headline">Deploying Jenkins to AWS</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-10-31T00:00:00.000Z" itemprop="datePublished">October 31, 2022</time> · <!-- -->46 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/QubitPi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/16126939?v=4" alt="Jiaqi Liu" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/QubitPi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jiaqi Liu</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of hashicorp-aws</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Jenkins is an open-source automation server that integrates with a number of AWS Services, including: AWS CodeCommit,
AWS CodeDeploy, Amazon EC2 Spot, and Amazon EC2 Fleet. We can use Amazon Elastic Compute Cloud (Amazon EC2) to deploy a
Jenkins application on AWS.</p>
<p>This post documents the process of deploying a Jenkins application. We will launch an EC2 instance, install Jenkins on
that instance, and configure Jenkins to automatically spin up Jenkins agents if build abilities need to be augmented
on the instance.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Prerequisites</div><div class="admonitionContent_BuS1"><ol>
<li><a href="https://portal.aws.amazon.com/billing/signup#/start" target="_blank" rel="noopener noreferrer">Register an AWS account</a>, if not having one yet.</li>
<li><a href="#creating-a-key-pair">An Amazon EC2 key pair</a>, if we don&#x27;t have one yet</li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-key-pair">Creating a Key Pair<a href="#creating-a-key-pair" class="hash-link" aria-label="Direct link to Creating a Key Pair" title="Direct link to Creating a Key Pair">​</a></h2>
<p>Creating a key pair helps ensure that the correct form of authentication is used when we install Jenkins.</p>
<p>To create our key pair:</p>
<ol>
<li>
<p>Open the <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">Amazon EC2 console</a> and sign in.</p>
</li>
<li>
<p>In the navigation pane, under <strong>NETWORK &amp; SECURITY</strong>, select <strong>Key Pairs</strong>.</p>
</li>
<li>
<p>Select <strong>Create key pair</strong>.</p>
</li>
<li>
<p>For <strong>Name</strong>, enter a descriptive name for the key pair. Amazon EC2 associates the public key with the name that we
specify as the <strong>key name</strong>. A key name can include up to 255 ASCII characters. It cannot include leading or trailing
spaces.</p>
</li>
<li>
<p>For <strong>File format</strong>, select the format in which to save the private key.</p>
<ul>
<li>For OpenSSH compatibility (Linux or Mac OS X), select pem.</li>
<li>For PuTTY compatibility (Windows), select ppk.</li>
</ul>
</li>
<li>
<p>Select <strong>Create key pair</strong>.</p>
</li>
<li>
<p>The private key file downloads automatically. The base file name is the name we specified as the name of our key
pair, and the file name extension is determined by the file format we chose. Save the private key file in a safe
place.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>This is the only chance for us to save the private key file.</p></div></div>
</li>
<li>
<p>If we use an SSH client on a macOS or Linux computer to connect to our Linux instance, we would also run the
following command to set the permissions of our private key file so that only we can read it, otherwise we won&#x27;t be
able to connect to our instance using this key pair. For more information, please refer to
<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/TroubleshootingInstancesConnecting.html#troubleshoot-unprotected-key" target="_blank" rel="noopener noreferrer">Error: Unprotected private key file</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">key_pair_name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-security-group">Creating a Security Group<a href="#creating-a-security-group" class="hash-link" aria-label="Direct link to Creating a Security Group" title="Direct link to Creating a Security Group">​</a></h2>
<p>A security group acts as a firewall that controls the traffic allowed to reach one or more EC2 instances. When we launch
an instance, we can assign it one or more security groups. We add rules that control the traffic allowed to reach the
instances in each security group. We can modify a security group&#x27;s rules any time, and the new rules take effect
<em>immediately</em>.</p>
<p>To create and configure our security group:</p>
<ol>
<li>
<p>Decide who may access our instance. For example, a single computer or all trusted computers on a network. For a
single computer/user, we can use the public IP address of the computer/user. To find the IP address, use the
<a href="http://checkip.amazonaws.com/" target="_blank" rel="noopener noreferrer">check IP service tool</a> from AWS3 (this tool works for VPN as well) or search for the
phrase &quot;what is my IP address&quot; in any search engine.</p>
</li>
<li>
<p>Sign in to the <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">AWS Management Console</a>.</p>
</li>
<li>
<p>Open the Amazon EC2 console by selecting <strong>EC2</strong> under <strong>Compute</strong>.</p>
<p><img loading="lazy" alt="Error loading ec2-service.png" src="/assets/images/ec2-service-6ac73bd57369973234f9192c71204b50.png" width="1828" height="841" class="img_ev3q"></p>
</li>
<li>
<p>In the left-hand navigation bar, select <strong>Security Groups</strong>, and then select <strong>Create Security Group</strong>.</p>
<p><img loading="lazy" alt="Error loading create-security-group.png" src="/assets/images/create-security-group-5ff4ac14e0e8e95d8f682b409efe1cda.png" width="1852" height="625" class="img_ev3q"></p>
</li>
<li>
<p>In <strong>Security group name</strong>, enter <strong>WebServerSG</strong> or any preferred name of our choice, and provide a description.</p>
</li>
<li>
<p>Select our VPC from the list. We can use the default VPC.</p>
</li>
<li>
<p>On the <strong>Inbound tab</strong>, add the rules as follows:</p>
<ul>
<li>Select <strong>Add Rule</strong>, and then select <strong>SSH</strong> from the Type list.</li>
<li>Under Source, select <strong>Custom</strong>, and in the text box, enter the IP address from step 1.</li>
<li>Select <strong>Add Rule</strong>, and then select <strong>HTTP</strong> from the Type list.</li>
<li>Select <strong>Add Rule</strong>, and then select <strong>Custom TCP Rule</strong> from the Type list.</li>
<li>Under <strong>Port Range</strong>, enter <strong>8080</strong> (Jenkins UI port).</li>
</ul>
</li>
<li>
<p>Select Create.</p>
</li>
</ol>
<p>For more information, refer to
<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html" target="_blank" rel="noopener noreferrer">Security Groups</a> in the Amazon EC2 User
Guide for Linux Instances.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="launching-an-amazon-ec2-instance">Launching an Amazon EC2 Instance<a href="#launching-an-amazon-ec2-instance" class="hash-link" aria-label="Direct link to Launching an Amazon EC2 Instance" title="Direct link to Launching an Amazon EC2 Instance">​</a></h2>
<p>To launch an EC2 instance:</p>
<ol>
<li>
<p>Sign in to the <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">AWS Management Console</a>.</p>
</li>
<li>
<p>Open the Amazon EC2 console by selecting EC2 under <strong>Compute</strong>.</p>
</li>
<li>
<p>From the Amazon EC2 dashboard, select <strong>Launch Instance</strong>.</p>
<p><img loading="lazy" alt="Error loading ec2-launch-instance.png" src="/assets/images/ec2-launch-instance-59738dc47bd4957dba4b4cb53920c468.png" width="1867" height="856" class="img_ev3q"></p>
</li>
<li>
<p>We will run Ubuntu OS in our instance, so let&#x27;s pick up &quot;Ubuntu&quot; and give it a name such as &quot;Jenkins Server&quot;</p>
<p><img loading="lazy" alt="Error loading ec2-instance-setup.png" src="/assets/images/ec2-instance-setup-9605d73972163ced5cc787992326c086.png" width="1590" height="1210" class="img_ev3q"></p>
</li>
<li>
<p>On the Choose an Instance Type page, the <strong>t2.micro</strong> instance is selected by default. Verify this instance type is
selected to stay within the free tier.</p>
</li>
<li>
<p>Pick up the Key Pair (under &quot;Key pair&quot; section) and the security group (under &quot;Network settings&quot;) we defined
previously</p>
</li>
<li>
<p>Hit &quot;Launch Instance&quot;</p>
</li>
<li>
<p>In the left-hand navigation bar, choose Instances to view the status of our instance. Initially, the status of our
instance is pending. After the status changes to running, our instance is ready for use.</p>
<p><img loading="lazy" alt="Error loading ec2-view-created-instance.png" src="/assets/images/ec2-view-created-instance-334c57b2830177602a82e77a8aeaa38b.png" width="1864" height="633" class="img_ev3q"></p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-jenkins-on-ec2">Installing Jenkins on EC2<a href="#installing-jenkins-on-ec2" class="hash-link" aria-label="Direct link to Installing Jenkins on EC2" title="Direct link to Installing Jenkins on EC2">​</a></h2>
<p>Now that the Amazon EC2 instance has been launched, Jenkins can be installed properly.</p>
<p>In this step we will deploy Jenkins on our EC2 instance by completing the following tasks:</p>
<ol>
<li><a href="#connecting-to-our-linux-instance">Connecting to Our Linux Instance</a></li>
<li><a href="#downloading-and-installing-jenkins">Downloading and Installing Jenkins</a></li>
<li><a href="#configuring-jenkins">Configuring Jenkins</a></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-our-linux-instance">Connecting to Our Linux Instance<a href="#connecting-to-our-linux-instance" class="hash-link" aria-label="Direct link to Connecting to Our Linux Instance" title="Direct link to Connecting to Our Linux Instance">​</a></h3>
<p>After we launch our instance, we can connect to it and use it the same way as our local machine.</p>
<p>Before we connect to our instance, get the public DNS name of the instance using the Amazon EC2 console.</p>
<p><img loading="lazy" alt="Error loading ec2-public-dns.png" src="/assets/images/ec2-public-dns-c1c6816553a3eb830ceaf3a87ea4ee28.png" width="1862" height="671" class="img_ev3q"></p>
<p>Use the <code>ssh</code> command to connect to the instance. We will specify the private key (.pem) file and
<code>ec2-user@public_dns_name</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/path/my-key-pair.pem&quot;</span><span class="token plain"> ubuntu@ec2-198-51-100-1.compute-1.amazonaws.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We will receive a response like the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">The authenticity of </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ec2-198-51-100-1.compute1.amazonaws.com (10.254.142.33)&#x27;</span><span class="token plain"> cant be</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">established.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSA key fingerprint is 1f:51:ae:28:bf:89:e9:d8:1f:25:5d:37:2d:7d:b8:ca:9f:f5:f1:6f.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Are you sure you want to </span><span class="token builtin class-name">continue</span><span class="token plain"> connecting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">yes/no</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">?</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Enter &quot;yes&quot;. We will receive a response like the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Permanently added </span><span class="token string" style="color:#e3116c">&#x27;ec2-198-51-100-1.compute1.amazonaws.com&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RSA</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> to the list of known hosts.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="downloading-and-installing-jenkins">Downloading and Installing Jenkins<a href="#downloading-and-installing-jenkins" class="hash-link" aria-label="Direct link to Downloading and Installing Jenkins" title="Direct link to Downloading and Installing Jenkins">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="installing-java">Installing Java<a href="#installing-java" class="hash-link" aria-label="Direct link to Installing Java" title="Direct link to Installing Java">​</a></h4>
<p>Jenkins requires Java in order to run, yet certain distributions don&#x27;t include this by default and some Java versions
are incompatible with Jenkins, because <strong>Jenkins requires Java 11 or 17 since Jenkins 2.357 and LTS 2.361.1</strong>.</p>
<p>There are multiple Java implementations which we can use. <a href="https://openjdk.java.net/" target="_blank" rel="noopener noreferrer">OpenJDK</a> is the most popular one
at the moment, we will use it in this guide.</p>
<p>Update the Debian apt repositories, install OpenJDK 11, and check the installation with the commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> openjdk-11-jre</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">java</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openjdk version </span><span class="token string" style="color:#e3116c">&quot;11.0.12&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-07-20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OpenJDK Runtime Environment </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">build </span><span class="token number" style="color:#36acaa">11.0</span><span class="token plain">.12+7-post-Debian-2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OpenJDK </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">-Bit Server VM </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">build </span><span class="token number" style="color:#36acaa">11.0</span><span class="token plain">.12+7-post-Debian-2, mixed mode, sharing</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="installing-jenkins">Installing Jenkins<a href="#installing-jenkins" class="hash-link" aria-label="Direct link to Installing Jenkins" title="Direct link to Installing Jenkins">​</a></h4>
<p>On Debian and Debian-based distributions like Ubuntu, i.e. our EC2 base image, we can install Jenkins through <code>apt</code>.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="long-term-support-release">Long Term Support Release<a href="#long-term-support-release" class="hash-link" aria-label="Direct link to Long Term Support Release" title="Direct link to Long Term Support Release">​</a></h5>
<p>A Jenkins <a href="https://www.jenkins.io/download/lts/" target="_blank" rel="noopener noreferrer">LTS (Long-Term Support) release</a> is chosen every 12 weeks from the
stream of regular releases as the stable release for that time period. It can be installed from the
<a href="https://pkg.jenkins.io/debian-stable/" target="_blank" rel="noopener noreferrer">debian-stable apt repository</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-fsSL</span><span class="token plain"> https://pkg.jenkins.io/debian-stable/jenkins.io.key </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/keyrings/jenkins-keyring.asc </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> deb </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">signed-by</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/share/keyrings/jenkins-keyring.asc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://pkg.jenkins.io/debian-stable binary/ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/apt/sources.list.d/jenkins.list </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> jenkins</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Beginning with Jenkins 2.335 and Jenkins 2.332.1, the package is configured with <strong>systemd</strong> rather than the older
System V init, so we would use systemd extensively to configure Jenkins next.</p>
<p>The package installation will:</p>
<ul>
<li>
<p>Setup Jenkins as a daemon launched on start. Run <strong><code>systemctl cat jenkins</code></strong> for more details.</p>
</li>
<li>
<p>Create a &quot;<strong>jenkins</strong>&quot; user to run this service. This username is very important because it would be used latter
during <a href="#enable-ssl-on-jenkins-server-ubuntu">HTTPS/SSL configuration</a></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>To verify user &quot;jenkins&quot; has been created, run <code>cat /etc/passwd</code>. Every user on a Linux system, whether created as an
account for a real human being or associated with a particular service or system function, is stored in a file called
&quot;<strong>/etc/passwd</strong>&quot;, which contains information about the users on the system. Each line describes a distinct user.</p></div></div>
</li>
<li>
<p>Direct console log output to <code>systemd-journald</code>. Run <strong><code>journalctl -u jenkins.service -r</code></strong> if we are troubleshooting
Jenkins.</p>
</li>
<li>
<p>Populate <code>/lib/systemd/system/jenkins.service</code> with configuration parameters for the launch, e.g <code>JENKINS_HOME</code></p>
</li>
<li>
<p>Set Jenkins to listen on port 8080. Access this port with our browser to start configuration. Note that this is not
a secure port because it is a HTTP port. We would change this port in a moment for better security.</p>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="weekly-release">Weekly Release<a href="#weekly-release" class="hash-link" aria-label="Direct link to Weekly Release" title="Direct link to Weekly Release">​</a></h5>
<p>Alternatively, a new release is produced weekly to deliver bug fixes and features to users and plugin developers. It can
be installed from the <a href="https://pkg.jenkins.io/debian/" target="_blank" rel="noopener noreferrer">debian apt repository</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-fsSL</span><span class="token plain"> https://pkg.jenkins.io/debian/jenkins.io.key </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /usr/share/keyrings/jenkins-keyring.asc </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> deb </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">signed-by</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/share/keyrings/jenkins-keyring.asc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://pkg.jenkins.io/debian binary/ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /etc/apt/sources.list.d/jenkins.list </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> jenkins</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enable-ssl-on-jenkins-server-ubuntu">Enable SSL on Jenkins Server (Ubuntu)<a href="#enable-ssl-on-jenkins-server-ubuntu" class="hash-link" aria-label="Direct link to Enable SSL on Jenkins Server (Ubuntu)" title="Direct link to Enable SSL on Jenkins Server (Ubuntu)">​</a></h2>
<p>It is very important to secure Jenkins by enabling SSL which runs in a project environment. This section is designed to
introduce the Secure Sockets Layer (SSL) application-level protocol, and particularly the OpenSSL implementation of
SSL, in the context of using in Jenkins. After a brief description of exactly what OpenSSL is, and what it is useful
for, the section will further illustrate the practical usage of OpenSSL in Jenkins service for the purpose of serving
secured Jenkins resources from our EC2 instance.</p>
<p>While previous familiarity with Server Sockets Layer (SSL), or the OpenSSL implementation in particular, is not required
for this section, if desired, the reader is advised to pursue further learning from the <a href="#resources">resources</a> listed
below in order to broaden his/her understanding of this powerful security layer.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a href="#resources" class="hash-link" aria-label="Direct link to Resources" title="Direct link to Resources">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="local-system-resources">Local System Resources<a href="#local-system-resources" class="hash-link" aria-label="Direct link to Local System Resources" title="Direct link to Local System Resources">​</a></h4>
<table><thead><tr><th>command</th><th>description</th></tr></thead><tbody><tr><td><strong><code>man config</code></strong></td><td>System manual page for the OpenSSL library configuration files</td></tr><tr><td><strong><code>man gendsa</code></strong></td><td>System manual page for the gendsa DSA private key generator</td></tr><tr><td><strong><code>man genrsa</code></strong></td><td>System manual page for the genrsa RSA private key generator</td></tr><tr><td><strong><code>man openssl</code></strong></td><td>System manual page for the openssl command-line tool</td></tr><tr><td><strong><code>man rand</code></strong></td><td>System manual page for the rand pseudo-random byte generator utility</td></tr><tr><td><strong><code>man x509</code></strong></td><td>System manual page for the x509 certificate display and signing utility</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="www-resources">WWW Resources<a href="#www-resources" class="hash-link" aria-label="Direct link to WWW Resources" title="Direct link to WWW Resources">​</a></h4>
<ul>
<li><a href="http://www.openssl.org/" target="_blank" rel="noopener noreferrer">OpenSSL Website</a></li>
<li><a href="http://www.ietf.org/html.charters/pkix-charter.html" target="_blank" rel="noopener noreferrer">Public Key Infrastructure (X.509) (pkix)</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-openssl">About OpenSSL<a href="#about-openssl" class="hash-link" aria-label="Direct link to About OpenSSL" title="Direct link to About OpenSSL">​</a></h3>
<p><strong>Secure Sockets Layer</strong> is an application-level protocol which was developed by the Netscape Corporation for the
purpose of transmitting sensitive information, such as Credit Card details, via the Internet. SSL works by using a
private key to encrypt data transferred over the SSL-enabled connection, thus thwarting eavesdropping of the
information. The most popular use of SSL is in conjunction with web browsing (using the HTTP protocol), but many network
applications can benefit from using SSL. By convention, URLs that require an SSL connection start with &quot;https:&quot; instead
of &quot;http:&quot;</p>
<p><strong>OpenSSL</strong> is a robust, commercial-grade implementation of SSL tools, and related general purpose library based upon
SSLeay, developed by Eric A. Young and Tim J. Hudson. OpenSSL is available as an Open Source equivalent to commercial
implementations of SSL via an <a href="http://www.openssl.org/source/license.html" target="_blank" rel="noopener noreferrer">Apache-style license</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="about-x509">About X.509<a href="#about-x509" class="hash-link" aria-label="Direct link to About X.509" title="Direct link to About X.509">​</a></h4>
<p>X.509 is a specification for digital certificates published by the International Telecommunications Union -
Telecommunication (ITU-T). It specifies information and attributes required for the identification of a person or a
computer system, and is used for secure management and distribution of digitally signed certificates across secure
Internet networks. OpenSSL most commonly uses X.509 certificates.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-openssl-toolkit">Installing OpenSSL Toolkit<a href="#installing-openssl-toolkit" class="hash-link" aria-label="Direct link to Installing OpenSSL Toolkit" title="Direct link to Installing OpenSSL Toolkit">​</a></h3>
<p>AWS EC2 instance usually have OpenSSL installed and configured properly.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generating-ssl-certificates">Generating SSL Certificates<a href="#generating-ssl-certificates" class="hash-link" aria-label="Direct link to Generating SSL Certificates" title="Direct link to Generating SSL Certificates">​</a></h3>
<p>Once we have properly generated an X.509-compliant SSL certificate, we may either elect to</p>
<ul>
<li>sign the certificate by ourselves by <a href="#self-signing-a-certificate">generating a Certificate Authority (CA)</a>, or</li>
<li>have a globally recognized Certificate Authority <a href="#applying-for-a-certificate-using-certbot">sign the certificate</a>. We
can use services such as <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Letsencrypt</a> for valid SSL certificates. But these certificates
have to be renewed every three months.</li>
</ul>
<p>When the certificate is signed, it is then ready to be used with the OpenSSL toolkit, or the library to enable encrypted
SSL connections to a Lightweight Directory Access Protocol, (LDAP) or Hyper Text Transport Protocol (HTTP) server, for
example. The following sections describe the certificate generation, and signing process for both self-signed, and
recognized CA-signed certificates.</p>
<blockquote>
<p>Note that this section has no Jenkins involved and sets up SSL in a more general context</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="self-signing-a-certificate">Self-signing a Certificate<a href="#self-signing-a-certificate" class="hash-link" aria-label="Direct link to Self-signing a Certificate" title="Direct link to Self-signing a Certificate">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="establishing-a-certificate-authority">Establishing a Certificate Authority<a href="#establishing-a-certificate-authority" class="hash-link" aria-label="Direct link to Establishing a Certificate Authority" title="Direct link to Establishing a Certificate Authority">​</a></h5>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>What is a Self-Signed Certificate?</div><div class="admonitionContent_BuS1"><p>A <strong>self-signed certificate</strong> is an SSL/TSL certificate not signed by a public or private certificate authority.
Instead, it is signed by the creator’s own personal or root CA certificate.</p><p>Here is what we do to request paid SSL/TLS certificate from a <strong>well-known Certificate Authority</strong> like Verisign or
comodo.</p><p><img loading="lazy" alt="Error loading well-known-certificate-authority.png" src="/assets/images/well-known-certificate-authority-040a261c728d656b6b5dea8efa649cc3.png" width="869" height="816" class="img_ev3q"></p><ol>
<li>Create a <strong>certificate signing request (CSR)</strong> with a private key. A CSR contains details about location,
organization, and FQDN (Fully Qualified Domain Name).</li>
<li>Send the CSR to the trusted CA authority.</li>
<li>The CA authority will send us the SSL certificate signed by their root certificate authority and private key.</li>
<li>We can then validate and use the SSL certificate with our applications.</li>
</ol><p>But for a <strong>self-signed certificate</strong>, here is what we do.</p><p><img loading="lazy" alt="Error loading self-signed-cert.png" src="/assets/images/self-signed-cert-839b8a47b22e8237992b369b32431aa6.png" width="872" height="1044" class="img_ev3q"></p><ol>
<li>Create our own root CA certificate &amp; CA private key (We act as a CA on our own)</li>
<li>Create a server private key to generate CSR</li>
<li>Create an SSL certificate with CSR using our root CA and CA private key.</li>
<li>Install the CA certificate in the browser or Operating system to avoid security warnings.</li>
</ol><p>Most browsers &amp; operating systems hold a copy of root CA certificates of all the trusted certified Certificated
Authorities. That&#x27;s the reason the browsers won&#x27;t show any security messages when we visit standard websites that use
SSL from a trusted and well-known commercial Certificate authority. For example, the following image shows the root CA
present in the Firefox browser by default.</p><p><img loading="lazy" alt="Error loading trusted-ca.png" src="/assets/images/trusted-ca-71edbd471ba4499018eae4443dcb696b.png" width="669" height="652" class="img_ev3q"></p><p>At the same time, if we use a self-signed certificate, our browser will throw a security warning. The reason is browsers
only trust SSL from a trusted Certificate authority. For example,</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Your connection is not private</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attackers might be trying to steal your information from demo.apps.mlopshub.com </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">for example, passwords, messages or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">credit cards</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But we can force browsers &amp; operating systems to accept our own certificate authority. So we won&#x27;t see the security
warning once we install the CA certificate and add it to the trusted list. We can also share the CA certificate with our
development team to install in their browsers as well.</p><p>Also, we can use this CA to create <strong>more than one SSL certificate</strong>.</p></div></div>
<p>Self-signed certificates have a major advantage in that they are completely free to use, and they may be generated,
signed, and used on an as-needed basis. Self-signed certificates are great for use in closed-lab environments or for
testing purposes. One of the drawbacks of using self-signed certificates, however, is that warnings will typically be
issued by a user&#x27;s Web browser, and other applications, upon accessing an SSL-secured server that uses a self-signed
certificate. By default, client applications (e.g., Firefox) will suppress such warnings for certificates that are
signed using only a globally-recognized and trusted Certificate Authority, but warnings may also be squelched by
importing a server&#x27;s root certificate into client applications; a relevant demonstration is shown later in this guide.
Using self-signed certificates in a publicly-accessible, production environment is not recommended due to the implicit
trust issues arising from these warnings, in addition to the potential confusion caused to users.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>We must obtain a certificate signed by a recognized Certificate Authority in order to establish a commercial site, e.g.,
for conducting &quot;e-commerce&quot;, which is however not the case in the context of Jenkins we deiscuss here</p></div></div>
<p>Provided we&#x27;ve have the OpenSSL toolkit properly installed on our EC2 instance, the generation of X.509 SSL certificates
is quite simple. For self-signed certificates, we must <strong>first establish a Certificate Authority (CA)</strong> by following the
steps below:</p>
<p>First, create an initial working environment, for example within our home directory by issuing the following command
from a terminal prompt:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> myCA/signedcerts </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> myCA/private </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> myCA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The above command will place us in a newly-created subdirectory of our home directory named &quot;myCA&quot;, and within this
subdirectory, we should have two additional subdirectories named &quot;signedcerts&quot; and &quot;private&quot;.</p>
<p>Within this initial working environment, the significance of the subdirectories, and their contents is as follows:</p>
<ol>
<li><code>~/myCA</code>: contains CA certificate, certificates database, generated certificates, keys, and requests</li>
<li><code>~/myCA/signedcerts</code>: contains copies of each signed certificate</li>
<li><code>~/myCA/private</code>: contains the private key</li>
</ol>
<p>Next, create an initial certificate database in the <code>~/myCA</code> subdirectory with the following command at a terminal
prompt:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;01&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> serial  </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> index.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now create an initial <strong>caconfig.cnf</strong> file suitable for the creation of CA certificates. Using our favorite editor,
edit the file <code>~/myCA/caconfig.cnf</code>, and insert the following content into the file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nano</span><span class="token plain"> ~/myCA/caconfig.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># My sample caconfig.cnf file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default configuration to use when one is not provided on the command line.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ ca ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_ca      = local_ca</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default location of directories and files needed to generate certificates.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ local_ca ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dir             = /home/&lt;username&gt;/myCA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certificate     = $dir/cacert.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">database        = $dir/index.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">new_certs_dir   = $dir/signedcerts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private_key     = $dir/private/cakey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serial          = $dir/serial</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default expiration and encryption policies for certificates.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_crl_days        = 365</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_days            = 1825</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_md              = sha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy          = local_ca_policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x509_extensions = local_ca_extensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Copy extensions specified in the certificate request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">copy_extensions = copy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default policy to use when generating server certificates.  The following</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># fields must be defined in the server certificate.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ local_ca_policy ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">commonName              = supplied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stateOrProvinceName     = supplied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">countryName             = supplied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emailAddress            = supplied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationName        = supplied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationalUnitName  = supplied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># x509 extensions to use when generating server certificates.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ local_ca_extensions ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basicConstraints        = CA:false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The default root certificate generation policy.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ req ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_bits    = 2048</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_keyfile = /home/&lt;username&gt;/myCA/private/cakey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_md      = sha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prompt                  = no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distinguished_name      = root_ca_distinguished_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x509_extensions         = root_ca_extensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Root Certificate Authority distinguished name.  Change these fields to match</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># your local environment!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ root_ca_distinguished_name ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">commonName              = MyOwn Root Certificate Authority</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stateOrProvinceName     = NC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">countryName             = US</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emailAddress            = root@tradeshowhell.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationName        = Trade Show Hell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationalUnitName  = IT Department</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ root_ca_extensions ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basicConstraints        = CA:true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Make sure to adjust the site-specific details in the file, such as the two instances of <code>/home/&lt;username&gt;/</code> under
<code>[ local_ca ]</code> and <code>[ req ]</code>. Also change <code>commonName</code>, <code>stateOrProvinceName</code> <code>countryName</code> etc under
<code>[ root_ca_distinguished_name ]</code> accordingly. For more information on the directives contained within this configuration
file, use the <code>man config</code> command.</p></div></div>
<p>When we&#x27;ve edited the file to match our environment, save the file as <code>~/myCA/caconfig.cnf</code>.</p>
<p>Next, we need to generate the <strong>Certificate Authority Root Certificate</strong> and <strong>Key</strong>, by issuing a few commands. First,
do this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">OPENSSL_CONF</span><span class="token operator" style="color:#393A34">=~</span><span class="token plain">/myCA/caconfig.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The previous command sets an environment variable, <code>OPENSSL_CONF</code>, which forces the openssl tool to look for a
configuration file in an alternative location (in this case, <code>~/myCA/caconfig.cnf</code>).</p>
<p>Now, generate the CA certificate and key with the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token parameter variable" style="color:#36acaa">-x509</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-newkey</span><span class="token plain"> rsa:2048 </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> cacert.pem </span><span class="token parameter variable" style="color:#36acaa">-outform</span><span class="token plain"> PEM </span><span class="token parameter variable" style="color:#36acaa">-days</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1825</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We should be prompted for a passphrase, and see output similar to this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Generating a </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"> bit RSA private key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.+++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.+++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">writing new private key to </span><span class="token string" style="color:#e3116c">&#x27;/home/bshumate/myCA/private/cakey.pem&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter PEM pass phrase:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verifying - Enter PEM pass phrase:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Do not forget the passphrase used with the command above!</strong> We&#x27;ll need it every time we want to generate and sign a
new server or client certificate!</p>
<p>The process above will create a self-signed certificate using PEM format and RSA public/private key encryption. The
certificate will be valid for <em>1825</em> days. The location, and purpose of the resultant files is as follows:</p>
<ul>
<li><code>~/myCA/cacert.pem</code>: CA public <strong>certificate</strong></li>
<li><code>~/myCA/private/cakey.pem</code>: CA private key</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-self-signed-server-certificate">Creating a Self-Signed Server Certificate<a href="#creating-a-self-signed-server-certificate" class="hash-link" aria-label="Direct link to Creating a Self-Signed Server Certificate" title="Direct link to Creating a Self-Signed Server Certificate">​</a></h5>
<p>Now that we have a Certificate Authority configured, we may use it to sign self-signed certificates. Prior to beginning
the steps below, we may wish to encrypt the certificate&#x27;s private key with a passphrase. The advantages of encrypting
the key with a passphrase include protection of the certificate in the event it is stolen.</p>
<p>The certificate cannot be used with SSL-enabled applications without entering the passphrase every time the SSL-enabled
application is started. This condition, while being most secure, can present a problem: If the server must be started in
an unattended manner as in the case of a computer restart, then no one will be available to enter the passphrase, and
subsequently the server will not start. One way to eliminate this condition involves a trade-off in security: The key
may be decrypted, to remove the passphrase necessity; thus SSL-enabled applications will start automatically, without a
need for us to enter a passphrase.</p>
<p>To actually generate a self-signed certificate for use with an SSL application, follow this process:</p>
<p>Create the server configuration file, by editing <code>~/myCA/exampleserver.cnf</code> with your favorite text editor. Add this
example content:</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># exampleserver.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ req ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prompt                  = no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distinguished_name      = server_distinguished_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">req_extensions          = v3_req</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ server_distinguished_name ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">commonName              = tradeshowhell.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stateOrProvinceName     = NC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">countryName             = US</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emailAddress            = root@tradeshowhell.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationName        = My Organization Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationalUnitName  = Subunit of My Large Organization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ v3_req ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basicConstraints        = CA:FALSE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keyUsage                = nonRepudiation, digitalSignature, keyEncipherment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subjectAltName          = @alt_names</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ alt_names ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNS.0                   = tradeshowhell.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNS.1                   = alt.tradeshowhell.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Be sure to change the values under <code>server_distinguished_name</code> especially the <strong>commonName</strong> value. The commonName value
must match the host name (i.e. AWS EC2 <strong>Public IPv4 DNS</strong>), or CNAME for the host we wish to use the key for. If the
commonName does not match the intended hostname, then host/certificate mismatch errors will appear in the client
applications of clients attempting to access the server.</p>
<p>Once we&#x27;ve edited the file appropriately, save it as <code>~/myCA/exampleserver.cnf</code>. Generate the server certificate, and
key with the following commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">OPENSSL_CONF</span><span class="token operator" style="color:#393A34">=~</span><span class="token plain">/myCA/exampleserver.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The previous command sets an environment variable <code>OPENSSL_CONF</code> which forces the <code>openssl</code> tool to look for a
configuration file in an alternative location (in this case, <code>~/myCA/exampleserver.cnf</code>).</p>
<p>Now generate the certificate, and key:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token parameter variable" style="color:#36acaa">-newkey</span><span class="token plain"> rsa:1024 </span><span class="token parameter variable" style="color:#36acaa">-keyout</span><span class="token plain"> tempkey.pem </span><span class="token parameter variable" style="color:#36acaa">-keyform</span><span class="token plain"> PEM </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> tempreq.pem </span><span class="token parameter variable" style="color:#36acaa">-outform</span><span class="token plain"> PEM</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We should be prompted for a passphrase, and see output similar to this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Generating a </span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> bit RSA private key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.++++++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.++++++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">writing new private key to </span><span class="token string" style="color:#e3116c">&#x27;tempkey.pem&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter PEM pass phrase:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verifying - Enter PEM pass phrase:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Don&#x27;t forget the passphrase!</strong></p>
<p>Next, we may translate the temporary private key into an unencrypted key by using the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> tempkey.pem </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> server_key.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We should be prompted for the passphrase used above, and see the following output:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Enter pass phrase:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">writing RSA key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If we wish to leave the key encrypted with a passphrase, we will simply rename the temporary key using the following
command, instead of following the step above:</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>If we use a server key encrypted with a passphrase, the passphrase will have to be entered each time the server
application using the encrypted key is started. This means the server application will not start unless someone, or
something enters the key.</p></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> tempkey.pem server_key.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="signing-the-self-signed-server-certificate">Signing the Self-Signed Server Certificate<a href="#signing-the-self-signed-server-certificate" class="hash-link" aria-label="Direct link to Signing the Self-Signed Server Certificate" title="Direct link to Signing the Self-Signed Server Certificate">​</a></h5>
<p>Now we need to sign the server certificate with the Certificate Authority (CA) key using these commands:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">OPENSSL_CONF</span><span class="token operator" style="color:#393A34">=~</span><span class="token plain">/myCA/caconfig.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The previous command modifies the environment variable <code>OPENSSL_CONF</code> which forces the <code>openssl</code> tool to look for a
configuration file in an alternative location (in this case, <code>~/myCA/caconfig.cnf</code> to switch back to the CA
configuration).</p>
<p>Then sign the certificate as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl ca </span><span class="token parameter variable" style="color:#36acaa">-in</span><span class="token plain"> tempreq.pem </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> server_crt.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We will be prompted for the passphrase of the CA key as created in the
<a href="#establishing-a-certificate-authority">Certificate Authority setup</a> section above. Enter this passphrase at the prompt,
and we will then be prompted to confirm the information in the <code>exampleserver.cnf</code>, and finally asked to confirm signing
the certificate. Output should be similar to this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Using configuration from /home/bshumate/myCA/caconfig.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter pass phrase </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> /home/bshumate/myCA/private/cakey.pem:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check that the request matches the signature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Signature ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The Subject</span><span class="token string" style="color:#e3116c">&#x27;s Distinguished Name is as follows</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">commonName            :PRINTABLE:&#x27;</span><span class="token plain">tradeshowhell.com</span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">stateOrProvinceName   :PRINTABLE:&#x27;</span><span class="token plain">NC</span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">countryName           :PRINTABLE:&#x27;</span><span class="token plain">US</span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">emailAddress          :IA5STRING:&#x27;</span><span class="token plain">root@tradeshowhell.com</span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">organizationName      :PRINTABLE:&#x27;</span><span class="token plain">Trade Show Hell</span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">organizationalUnitName:PRINTABLE:&#x27;</span><span class="token plain">Black Ops&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certificate is to be certified </span><span class="token keyword" style="color:#00009f">until</span><span class="token plain"> Jan  </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token plain">:50:08 </span><span class="token number" style="color:#36acaa">2011</span><span class="token plain"> GMT </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1825</span><span class="token plain"> days</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sign the certificate? </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">y/n</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> out of </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> certificate requests certified, commit? </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">y/n</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Write out database with </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> new entries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data Base Updated</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Remove the temporary certificate, and key files with the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> tempkey.pem </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> tempreq.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Hooray! We now have a self-signed server application certificate, and key pair:</p>
<ol>
<li><strong>server_crt.pem</strong>: Server application certificate file</li>
<li><strong>server_key.pem</strong>: Server application key file</li>
</ol>
<p>Next, we shall use the certificate for our Jenkins instance.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="chrome-bypass-your-connection-is-not-private-message">Chrome: Bypass &quot;Your connection is not private&quot; Message<a href="#chrome-bypass-your-connection-is-not-private-message" class="hash-link" aria-label="Direct link to Chrome: Bypass &quot;Your connection is not private&quot; Message" title="Direct link to Chrome: Bypass &quot;Your connection is not private&quot; Message">​</a></h5>
<ul>
<li>
<p>Option 1 - <strong>Simply Proceed</strong>: If Chrome says the security certificate is from the same domain we are attempting to
login to, it is likely there is nothing to worry about when this warning appears. To proceed, simply choose the
&quot;<strong>Advanced</strong>&quot; link, then choose &quot;<code>Proceed to &lt;link&gt; (unsafe)</code>&quot;.</p>
<p><img loading="lazy" alt="Error loading Chrome-Advanced.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAGjCAMAAADtgxf3AAAAYFBMVEWcrcLfW1HHPjLOpIeEb2iCsfaJoLy/NyybhXpvf52svtL1fXv+AABkYmfq177avaOszfClnJrQysns8vDaQzZMjvr29vbwyGngu2Ld3NrAn1OxlE20s7Pn29Xx6drP4O6/cVupAAAbfElEQVR4XmKQEhcXl5CWlJSXG/ZwFMpKS4iLi0vBIl1mBIBRIIka6QB27li3dRwKgzBIFioIiI2wHfn+j7l2aIm5V9e7m25z8o0VGHI7mPCHHeevHwB+ld4J+AmELB2kg3R00pUO6x1KB+kgHdY7lA7rHUoH6SAd1juUDusdSgfpIH1hvUPpwbHeoXSQDtJhvUPpsN6hdJAO0mG9Q+mw3qF0kA7S0UlXOqx3KB2kg3RY71A6rHcoHaSDdFjvUDqsdygdpIP0G9Y7lA7rHUoH6eMFAT9D+uh7qSkdx5FSLa3HF2+97yUdn0m1xdau9H4pX6S6ExB4ve/1+BMpbuxK31fmsa2TfndeS+t9jL63mk7rBISUPqbgVPrnF9vr1ZDnuvVelt0/nPPVhg9Y+khvih7TeiMg3npvb8/unoKmrvT63mw7noSTTvqeztDfpW7Ah5PePqSv4X4/1SsB0dZ7+aeJ3kJKV3r9V+mJgEDrfUkv7w78ENKV/nXpBwGkf2tIX385kd5wfrA+CAiy3kc5/iu1ExCh9Lvz+Nat93Z8hUpAgNJ7Or5EgA/WSW/p+Gmpk16OLxDjPRrrvQaRrnTSrXfSlU466aSTntLtJrh06z3tva6b1mtk6Uq/vuww6uV83cSVbr23p4BeT+cP9hRdutL7tH45HyVHl27I1Zf15Xzboku33us+rbcPASVvD8JKt95X6xdlm8SVrvS14Cd1O4ku3XvvaVydT/K2hZau9JV62j4RWTrp68urfVnPWw4pnfTlfFlf5JjSrfflvPVp/Qp9Wg8nXenLednSfv8NH0669b6cj+duT6/W86v0BzmidKUv59ur9T2v0rccUDrpdTmfrY+SzyM9P64cULr1XsdT82V93TzIMaRb7+X4jVqX5pw+bmbrkxjSlZ6vx/M68vYL+XqKId16v5f+xnq00pV+Xefz9hvnCzGkk15O3/PnyHfr60gPI91XlfN8PGVfxW93pvdCwPdf7yNdha81l2+t55NOwLcufaV+Hebrsazntd2jhO4/RrbZ+Svz1ftS/sn5ICBC6c/W03mq51vri5xTC+Cc9MlopdQPSn1Paf+/85x0WO9QOqz3gCgdpIN0WO9QOqx3KB2kg3RY71A6rHcoHaSDdFjvSifdeofSQTpIh/UOpcN6h9JBOkiH9Q6lg3SQDtJBuvVOutLhvXcoHaT/zd7Z6EauIlHYkh2EkdoYSorkGQfe/y33nCqI+/ZsdpRo9t7khtK4AeoH3F+XQ9IeLLPfrTavqPydEn34ncm81j8FoHgnA3qTbVnFyr/tTZGoQ8Xl6W2b938Qt7T/b+irvD2d77bfe7rtBOFR/E1SPBL4j8uPj55AWVb5XpluKW6vXxv6/GHo/ttBtxwXbxdSyWdKoWotCAGx4EtO4dVjg5FpY0qnAixnLTlNmb3bWSWy3o2neu+X03Jz0w4X88yIka0WaBIuBJuavA73OpAZtQlMWW0Q9NVqSzCiU3OIU5UYnl9wUPJZ25kKynTDdNo4U/4W0C3JeRAAeEDW2tLRCtb5niqMbsQPSUQFEoTVkNgbnq2+tP4S1Virs5qHWZ2cxGUnH6+9zoakNev3C7nobTiTsrgevDuvcIgatKUsWvtskXQ2HhMonmf5ek4SbVgR38/BesL3gC5+DUkTXWbgOXLim3dBZ539bF5G545Py23KGZzgu93WNWSohNCXNSMKAoAsjPECZ/U70l6y12ib+vmbywe4BiFCRl5u4X4hV7QztdE5aELEGzRQwZkOkyDobTq6EdRJIz1pHUZC6CWt1VaQUmZ6esbfOIA8s8h5Qc93gE5glujMhHbBf8h0MlG5jMzM3JlpxG1d0S4VqUch+iAFfjR5XUgz0yUCmAbtw9DYyZXpULm/TFaxyMyUnG/XtO8XcjYDU7AuOihsEZq+VHIqGAqjY2Kqby7ue9w5I17zhgRC4+oeoLNOMaOHVe9PeDc00aA/9Xpe3AFBIew1sXDM9CvyfDW2a7QfK3tvocrDuhPOk8irM8weoO9dYRgNOskK4rtqqxdcz12DzkS3ma7yPb5ls9xiCuwN5z10udDcGxnnDkx/QBvvq76DdBNC3++hq1mv9oZr0O8y3X5wuyoP0JGjRNgYB0Kvv0JHyXqHLjbVQPxYAXh/c88dep/pKt/jvne+g53n25n+NnTm062DJsDQ6jjWpBL+Cl1+yXRA337NdK1xvb/uj9DdHfS3Mv0HZ3ZBV7eSbIHhchUN1qGvySX8C98k0w06aa3S87UkoKTKoMtdFjm5T1jLFCI1T2HWitaDITLZ4PeY6VLSLUjvahDLQ6ZD7Od8n2tnL3Pn+St0mhNnvc90Nc1+Ev04mJ3Nv72afC/oxROMRIKWma+bv1byJuyaoM6Vy/iqTk/Pb2Q6lQxdQtXgMM/VIJkLxwrQJ0LdjLYV1zWEqXdBL1emMzt3zM7Wc1zaXdDXIH1mywWdmtQXgiKbrRx5duyZUJRYvxd0Vm43/SX4tZ4eM73/dg4coK7ilMp/zXRGYRgE6VX1IxS6oK7RaEAuj9BvFdE0wH4/117MjEhn4rSZ9ExfuuLKdEt+M9roCSs2fuh0oNFg+ze5c2bzoecRGCyuWm9abtORmOkzui4pUKzqkX3HsXkrCDJanVDNmCne/SbRUdZAW/Ps0fpCjsV1eS/RAlxztcLYt6lQYDe9Qt83T8U1MwF0C2nNDP1uwUqyy81sH5OvmelDmN3/GhnQB/QBfUAfMqAP6N/pvvchIuPGyCED+pABfciAPmRAHzJW70NGpg8Z0IcM6EMG9CED+pCxeh8yMn3IgD5kQB/QB/QBfchYvQ8Zmf6+jbu29KD6nVV08i7/ksKHAXCw39tMco21ho8GLWnZ/03Qi/c7C/CRtL8T+qPEVTlIDG/s80XNb0Xm/VdFifuvg713J7M35Ldzo++/CfrmeEYlLuHQ/1FUjpxBTjIKQt/AveRcn+U4cpUXaiGlvuTDWnIIzQ8UcVVvBMqi0AM9WwBK9g4x6gZfxqDrVl9tDvWSvEyHMDa7m7fkxJjsNFNpJAraCMM+er9QzbM4ULFqLjqn5OrlXzJmgbpNzMbaUgp0aKFkwzRrSwwHe5x+H4UqYdgvCZ1ZxXwsaUnhXNZge0Dpvk2pAvrmA9g5bbi0o9spiuhT8jBdd+az0BzOcT218GuAFeEzjAWw3S44xAwrNqMrKYh3J21KYgjFqPPIbAe2GdzJjE7WOH50VBG65XtJVd0nER8YF0OoL2xqXF3yE+c01Y1WOs3p0HF5BsCNwnFusHZiRrVPTM9jTdm7NoqrBXVv1S8JvfjKd54lyIOEgNEqOVUp4BzSJNTL/KSbOfx4epaiIEB7XneZHaFvK8kG7Y2uwho2hE5PJxFFy8sYnuXHWkUB7Qp9lYLWTJi2vIBCo4Ex25yWcBZa21hCBYyr2AlwyHkVTqQY9NIXKgp9Z2B6QCutS3RcvwLgjnjPKPo0Z9dCOT11zQz4cusGGyUIVBuPtH/J1Xt05GHQQQFYcgKGOIlCW4Pw1fvFEQM4BzG/REbCA9BnRjgJHeZACrR9TYD24RcEUET8OICv+sNQoe/ssbFX6dCjuhp0DGroI+L4JUiJadGkpPGPJ45Md5nDa6ZTp5l+PydUEZTQRdeQyvQHxs8pLTvdYbJBwZMpOrHJoAcF3EehqiQ9vmKmF39blttae6bjSBl5kRr0BSVoH6UKtXx7YGzXTbx9zBuFDjO5g94znS6bywhwVJG2XIeWlYpCobPHlXvoP3eJUzV/OmW9GhBaZqDipzwrOktmTcvacVimO+mZ3qH3a0NJ2sVxywm+M2inkL1CF43G8zPoLQ7YK+gGXb42dBIiCWmZTk7oJFOFdvpg6ESKZoAaW6Yb9JX6ljpwA3S4dugNAT9CBkE69Of5BKcr04tH53Zl+tYzXQUAJD2RXVu2S2yZTohu0p87ZKCx5zcy3fxjy3RYAroAuia9QWfshOIlPWa6ArePa8v0+jWh95MC4uJDRatuaWJe4aRztIXcLlEbPEOJoW0Y+tdML7RYrkyHtu0SkrMFOM69UagGffPu+Q66DpJu0mZVgTK3oUpErSJ5D9jlHOq2huwV3bX30eZD1jUedW9luvqDacv0C7rD7DlNzlwY/nRV7qBHQm+jIORdpn/F3aViJhxuCgMwAuI4UkYuo3D15UT/JAACpW7mqjVNYhR2AEql+QkNexis2IawL9GW6ZLhVi35UYnkr5mDmDKjxIiwcXmVbqSD7trUGjsnKTE5VU1n1sEotvzbbAhYBETLTZfbnKYqebdQnPQkqOrWOXDf1RdNwKd1CyUzlUFamBLbKA4qGmc9vvkXLu9cyhLVg2gGvlskTTLunPkHpCRIkPc4PJpvyX/o196YUh3fsv0Ton+uek++lZf62HMcx0folUOeB/Qh3wn6kAF9yIA+ZKzeh4xMHzKgDxnQhdLKq/mm7XP5b2p2flDEwn5IivyB0/9+0G2D7sl2ZF4Dv459c79k25DftmB/VLDzQ5KnWtI6ycfm/vQH/sBcvx/0LaW03II+nQO0AT2lqb5pHN6CPn0MeknBvnQd0P/M6n07kbkxVFSUIxv5nOoLDjZSiKnyL53gCNh78Wsoi3vlcQZEqBus7VmKDGTQqUQTxPSrrcpMz2iw34ba1J6ivkHal3ESpwMBGbQlGhPd7ZwjI+bcv6bV8QLvypSNAdDgELlVqSZ0yWfaXwnmrIFfTlrRr1o9X9+eWbASMgIgypnQpeYqhYNURtGJt1Ov+m7xHeWrQJ2DNL2gc/80mc7kfd5+rnVb2vMTUWHV4xBQhvQn8D5tfq3gOW3LqhvxX9Y4HOsoyLZBl5+4Oszw6wraImkR1R7twLLv/68WalhLm0LXRof3cw11S4Hvf/EutP58urp5KHaJIQJsvIXoSSnI7KFOFdDJLfr9+vFDU8kxwGqD8V7wAgd98ADTGvAidTeXra73dZ25QUeEnDwG4bwmlDXDCFEmRCmcSEWUM/tVqI+uohU/GXTCnG/rUYUYf95cvPFYK44QFTp48IPRoF+0UOVzNCe4S3nhQw9rg27B3eFvtRy5R4NdSbc1o4RmygnGNNTHLCJ+yP4WENRFHv15ccwfxD+d2G0rwRJurWyCPW/o6/fogTL6o2NBNaAXZtnsOnT2M/2faRUR025/E7YSjqD3+2xAte4aAd2ow+7ubqMMG/Txwi8+0AicYW6PKdzp9hxNX/weHcw+F/Tyk0SAxKCvTLW9gBYAC0qeOiH3TJf+zBtCX6sdN1pCdoPeH5d0LiuNIZWKjbDXvWtI256a8yS20pP+QYGV/MTQ1Bp0ZQc0xZK2PxwV4zJGTgvqkTEdADSckdA3NURTBQQV95a8zg08SuK5A1DKvp4hMh5GI+gNamqKp4kJ9UpzlTaHvDDKTBPhRHad46XfOMVPBV229mAmckR5D90RJesrVKwKTp440yP0ldZ5uYdOmAtdmLgGPf4FeuXwBh25WtAQumrADh0SO/Sg0JmAFAKmFJiikeVs0INIdmI36Cp0ZnoXadA3H2Szh1Mh6zfP+OdU54lZbdBjh57pkj2r99C3lcH6w292jVIjyM+7DnnpOYr7PNCRBSfTeMsnH1GbiW/v0EEBytuegShnZrmi4koKVrLB+sr0CrbnXabnLIy+VrBzSaFPzHRGyQnwae/Zl3WgMyDQicABw99DlzgJoYN3JQv8U9rMJoHMLjqghapBPysz3dDsenlHgCJySEMmMG23cIvwFeqlyukneCVqkbAO8IVBOUK1y/dLfch0hVsYZXZ28/zsBK8cUuK9HsHg/TlW7wVQ1xvTFGXAZfb+8o4DSnKkONnYDgKULJDB4S7TJUJ5ZTqpgQsaaFHRM12jMMG1dFV4KZmvhdwkBQGLQtec7lmFMk1g0DNdYmtyhQdYyb9mOqHPfoJ9BXTJyXEBmHb18i4lBxxaRC76jhNVOHou5QIDQxhZWt3VjT1H2h+gF6rPyte9MAqr54KEQJG6XjJUE8b/LL+nbzEcGSCRaeBwVkFDYpb2uPwzkUA8Ifw1J4asvbqSRYrCym4VzXocMcC4yoaC/iAfnmHfhkByxMw2xoK/jYkBK7tYtcBiwUQ1ENIqHBDz0ElZxtA8HLLB76io5wNxAiZ50EZml09aUr8xLscn9JSjjsUTxzjQSGZcDSw4ODM9T3Zq4EPtanE2H+oOzlPaxF/i3TmEzDhobKvpqbLxv8IXLiV5r0+v+5iIt8fw/SN/HJH5cd45iEGvH55HkHdYF//0OP6XgM4L8MenKj/J/E+I/In/vc6mQf///w1e4rI8/t1YxrdsQwb0IR9bvQ8ZmT5kQB8yoA8Z0IcM6EPG6t025pLf2ti0UH59GZkuMdQtCHj+fqtFydOXpz6gU+LZd175/YaMJYVPDmBAL8l7sCxrTHtrr7WkM+0S/QqNJJ/SJJuTtNxWaTauQu0nkRjmVNmRnGi/pvyQz7znTAHPrDcBBhFtu5prWVzbdWiXmbexOIl660pVHx/KUUuuWdW70GlbnECfq95s8pllZHp0tW/kd3cP0qa3/YWSk34p3LZgE7twX/cYvqQJ0NW/7/kJRfnk0MfqfZ6k3fkpHahBt90Z1xCpiKdCnw2qsS9Rd4OFgxC6RN05M8sXgD4yndATofd2u/2s5f6vmQ72+upqiVPf8tM8S6TjgP7pd4wM+nO9Qbebt4WZzl45pCyoeiebQpd+j5jIDCfPTDenDTZVnv0T6NcCw88rY/WebSevDp1rclcJHRj9So3X1XuEQfRtJ2d0Ve0ndDGn5Eqir26eu37aZB/QKXIISdbelJcqEFZLVcYHmyLUmVUxm97PDtbNwa4V/2HXjm0AACAACPYahURn/zXtoHW/wkWDfpTde2UQ9zkjVzZBF3RBF3QNdJMu6IIu6IIu6IIu6IIu6IIu6IIu6KegC7qgC7qgC7qgC7qgC7qgC7qgC7qgCzp06NAFXdAFfdk7w95GYRgMD/WMACriYLA0ieb9//9ymHSt7k67bm3E0ZJHE4sT2i+PbKcCRHCuvRfngj4dWborjo8xtPo6CNPKsKwuPRTHxxlO+irwuDq89psdXJQ2tPdSDEejzdLvhlbO9HYRFvQRQvtM1rP0YFne6aOcLNudPgVZejE7D5qA+EWbJ0uPDb3TFIT7C3yWzqtKH9KZsg1hln4ftObu3dIzaCKG7Xf1XN5jdg6aiva/1vcs/fR9T4V+hyydjD/nvqGTaLWentpTlg5hBn43KHxLLV0+8k/5tA3poYfeIvCepGMcWcYvpMsXSq8LwGalB8/nwcR6C1fuUDoBoJHYYmFik0pQxCmDYkVggC8LxKJs5yLp7j2NdFe/fUqH3qLblXQVsSWAgFHsSIKzZxYaIRQjhg0IxMokbAvLFIFHxvZ6uvjGQ7XztS+bA2twTV/9KhH8VNWs4qq6kb6q3yTMQ7+/TKeRiAUUTxLFWZqMNsUSg5j+vEinUWyBgHFRv73y3pXiGqvx0tVwpZ4m9JjD4OcFj84jvNvBc18i7E665SoEJp0W6SL82bpNL0u0vRR1AZSXBQHOyc9Cm5Muh0a7N8zqracHj76R0Pe+sVY/h1MjKs43zpeu2WFPt2KtTIANiEYBX8u7nIu3LbASm+7PTCdaPg+R7W3kQlV6X/Mi3UMPjePg/GTSl/w309L7aZr6/UlXjps3sMBKOHgUJvAizYwLYsBgYAkFMf8BjLCR8vZ+p7uyt7zuPGvvWbs6VvRLprsS8t57qIoND3uSTsb1//lgf0aMLsH1xPMoHizvt7Z7n+2KauexbNKgUll+V+VFerCNXHyTvs3vQHpaGBv8nS4zQS5cQ/1rKpKl/wQGb0R6cY1Ovvoh0/NJz9fTu91dcMmXVk36UfdyPT1LTy/qFG/I2Dr5zhltzVSyRB90++SeruGYqqu38RbL7ZPLu7pEN7G2T3YzbH7CZXD6GKE4Pktxz/fIRV8mrL0f1xYv9Qgj1ne+bk+PuZ6CVl8F4dWRNLv3lZ9VHjp9MvKbHYJrH+KDnTskAgCAYSDmoqzzL3MehgYSC3+lnRzhcwbRER3RqeiWjuiIjuiIjuiIjugPiY7oiI7oy37ZrUgWwkB4rgU8Z1NwQNDk/d9yrfwgdMOw7LJXPQ6tkJTG4bNsexl7xYMuIqbCZp7K0KMigxGtTGaHGDwoeNbWgCFqUJIVE5Cjjsio8YNTXzUqYJjHkBVic4hg9pWpyt4UlYIh6oN9xhAZ39/Ax0PH1QiiB9phWMMRs2Xo6W0MsQcUHOpr7IanU4LMYXdtlAQSEq2Jfd4Rb+DHS1w369iIEzSb5wtlbc6Fdra7hbEtS2UX7JQ5ZghH9qyMc5Ts0cYdCT7d6SINCR2JqqBVaDkXYBjHYp7ybqWEWFiwmhjOqDurrBUoIFeQ2GEcQRMr6GyXQxNzrB4Nshu4ZeWC/iDE697J2ruKWEFnr6wPsU93ukCsoBcrJ6CCgk4PtoBaKi0/9xil7tdxVwFtOQpy6BL8RgMPW1E5Am1Ef5wuJubQa5+43KcQeYfeBxXL4Gi7YIfMRcMQvd7wjeHjoasgoBtQTgehs2doNaCHIZkskudihec8hOP0gtLvmtGFPFTgSzO/xsa1pATasJgrnJwC8BzpHSUvo207e6Zw7h10o2LdTNcJBUMvTt85fPr1DnIj9GvOGbwzVaFeCR9foc/ZBrCVzXPj/g46Cy2HE6dqmAdwoKsYjtNBeOl2FWe5BiAYBm7LleV0V646ISB8LpfQj9Mh9vFOf9Rdh/fv9CdCtAhldNfhUUgtl8lcOb1gEwFSstGo5DfH1nUCdKejoN8c6kAlanh9GTKNTlceFMbernfKLB8gvubVhlz3m9P1x+ngJUsj9eT5/pAzkCDEThLv0FXsOP3MZjyFXQARd2rw3J2jOq9rLjVyYtq1USWkLsBlsdtheIfO0ev3mzW1DRFpeP1O7z8PObCbLw85LGjSCKPgMh9LVbkDPd9Oyw4J+gpbUkklmhal/K5uMf8IOEPd0uf8ybwhliXzN8Cr05cAPcVUNkFeNRB7cfpi7sfpjxL69WtOd9p5vV+ToTQPoR+Hk82kB+fXbAZBQKG4ms+3lFpyRXyiioXtsAXE5FDo7ayhtbk8amJ0utca8dT4KqU7vX7384hmx9Ue4X8GOp2bHXg+FfrfNygU30t2Hv9mJwX+bAX43/9tP9BVaH/7TtInJX+Polb4E+ZCpf1mj44FAAAAAAb5W++eQykkHelIRzrSkY50pCMd6UhHOtKRjnSkn3SkIx3pSEc60pGOdKQjHelIRzrSkS5dunSkIx3pSEc60pGOdKQjHelIRzrSkU5DiXQpyREBRoEULNJBlJT0CACjQEpCHBrpYCAxEsAoEIdF+sgBo2AkRfooGI300UgfcWAUAACSSpuhnF7X7AAAAABJRU5ErkJggg==" width="500" height="419" class="img_ev3q">
<img loading="lazy" alt="Error loading Chrome-proceed-unsafe.png" src="data:image/png;base64,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" width="578" height="195" class="img_ev3q"></p>
</li>
<li>
<p>Option 2 - <strong>Prevent Warning</strong>: Click a blank section of the denial page and use our keyboard, type <code>thisisunsafe</code>.
This will add the website to a safe list, where we should not be prompted again. <em>Strange steps, but it surely
works!</em></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="applying-for-a-certificate-using-certbot">Applying for a Certificate using Certbot<a href="#applying-for-a-certificate-using-certbot" class="hash-link" aria-label="Direct link to Applying for a Certificate using Certbot" title="Direct link to Applying for a Certificate using Certbot">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Requirements</div><div class="admonitionContent_BuS1"><p><img loading="lazy" alt="Error loading certbot-requirements.png" src="/assets/images/certbot-requirements-b1ed3b3a8372e888a07e0ccd30164354.png" width="2100" height="558" class="img_ev3q"></p></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="install-and-setup-certbot">Install and Setup Certbot<a href="#install-and-setup-certbot" class="hash-link" aria-label="Direct link to Install and Setup Certbot" title="Direct link to Install and Setup Certbot">​</a></h5>
<ol>
<li>
<p><strong>SSH into the server</strong> SSH into the server (i.e. EC2 instance) running our Jenkins instance as a user with sudo
privileges.</p>
</li>
<li>
<p><strong>Install snapd</strong> from command line</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> snapd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Either log out and back in again, or restart the EC2 instance, to ensure snap&#x27;s paths are updated correctly. To test
our system, install the <a href="https://snapcraft.io/hello-world" target="_blank" rel="noopener noreferrer">hello-world</a> snap and make sure it runs correctly:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> snap </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> hello-world</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-world </span><span class="token number" style="color:#36acaa">6.4</span><span class="token plain"> from Canonical✓ installed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hello-world</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello World</span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Ensure that our version of snapd is up to date</strong> Execute the following instructions on the command line on the
machine to ensure that we have the latest version of <code>snapd</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> snap </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> core</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> snap refresh core</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Install Certbot</strong> Run this command on the command line on the machine to install Certbot.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> snap </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--classic</span><span class="token plain"> certbot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Prepare the Certbot command</strong> Execute the following instruction on the command line on the machine to ensure that
the <code>certbot</code> command can be run.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ln</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> /snap/bin/certbot /usr/bin/certbot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Install Nginx</strong></p>
<p>We would choose Nginx instead of Apache server in this case by installing Nginx using</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> python3-certbot-nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that Certbot does not install nginx for us automatically and will through us an error, in the next step, of</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Could not find a usable &#x27;nginx&#x27; binary. Ensure nginx exists, the binary is executable, and your PATH is set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">correctly</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Get and Install Certificates</strong> Run this command to get a certificate and have Certbot edit our nginx configuration
automatically to serve it, turning on HTTPS access in a single step.</p>
<p>:::note Prerequisite</p>
<ol>
<li>A DNS domain record, e.g. &quot;jenkins.my-domain.com&quot;, has been setup to use</li>
<li>The server running Jenkins can be reached at port 80 publicly</li>
</ol>
<p>:::</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> certbot </span><span class="token parameter variable" style="color:#36acaa">--nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Enter an email address of ours</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> certbot </span><span class="token parameter variable" style="color:#36acaa">--nginx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Saving debug log to </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter email address </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">used </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> urgent renewal and security notices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Enter </span><span class="token string" style="color:#e3116c">&#x27;c&#x27;</span><span class="token plain"> to cancel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next give content to the Terms of Service and decide whether or not to receive promotion emails from Let&#x27;s Encrypt
and Certbot</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Please </span><span class="token builtin class-name">read</span><span class="token plain"> the Terms of Service at</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://letsencrypt.org/documents/LE-SA-v1.3-September-21-2022.pdf. You must</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agree </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> order to register with the ACME server. Do you agree?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">es/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">N</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">o: Y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Would you be willing, once your first certificate is successfully issued, to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">share your email address with the Electronic Frontier Foundation, a founding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">partner of the Let</span><span class="token string" style="color:#e3116c">&#x27;s Encrypt project and the non-profit organization that</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">develops Certbot? We&#x27;</span><span class="token plain">d like to send you email about our work encrypting the web,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EFF news, campaigns, and ways to support digital freedom.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">es/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">N</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">o: Y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As the last step, provide the domain name sitting in front of our Jenkins instance. Let&#x27;s give it as
&quot;jenkins.my-domain.com&quot;</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Account registered.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Please enter the domain name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> you would like on your certificate </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">comma and/or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space separated</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Enter </span><span class="token string" style="color:#e3116c">&#x27;c&#x27;</span><span class="token plain"> to cancel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: jenkins.my-domain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Requesting a certificate </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> jenkins.my-domain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If everything works successfully, we shall see the output similar to the one below</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Successfully received certificate.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certificate is saved at: /path/to/server_crt.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Key is saved at:         /path/to/server_key.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This certificate expires on ****-**-**.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">These files will be updated when the certificate renews.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certbot has </span><span class="token builtin class-name">set</span><span class="token plain"> up a scheduled task to automatically renew this certificate </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> the background.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Deploying certificate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successfully deployed certificate </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> jenkins.my-domain.com to /some/path/</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Congratulations</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> You have successfully enabled HTTPS on </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">https://jenkins.my-domain.com</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>:::tip Troubleshooting</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Please enter the domain name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> you would like on your certificate </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">comma and/or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space separated</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Enter </span><span class="token string" style="color:#e3116c">&#x27;c&#x27;</span><span class="token plain"> to cancel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: jenkins.my-domain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Requesting a certificate </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> jenkins.my-domain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certbot failed to authenticate some domains </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authenticator: nginx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">. The Certificate Authority reported these</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">problems:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain: jenkins.my-domain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type:   connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Detail: </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.: Timeout during connect </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">likely firewall problem</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hint: The Certificate Authority failed to verify the temporary nginx configuration changes made by Certbot. Ensure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">the listed domains point to this nginx server and that it is accessible from the internet.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some challenges have failed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ask </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token builtin class-name">help</span><span class="token plain"> or search </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> solutions at https://community.letsencrypt.org. See the logfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/letsencrypt/letsencrypt.log or re-run Certbot with </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"> details.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This problem usually happens when we are re-deploying certificate. There are cases when we would like to deploy
Jenkins to a new server or VM and we are setting everything up anew. We then would want to request the same
certificate. <em>But before we do this our DNS record (i.e. &quot;jenkins.my-domain.com&quot;) is still pointing to the old
Jenkins instance which in most cases has already been unreachable</em>. The solution then is to delete that DNS record
from our domain config</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Please enter the domain name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> you would like on your certificate </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">comma and/or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space separated</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Enter </span><span class="token string" style="color:#e3116c">&#x27;c&#x27;</span><span class="token plain"> to cancel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: jenkins.my-domain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Requesting a certificate </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> jenkins.my-domain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certbot failed to authenticate some domains </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authenticator: nginx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">. The Certificate Authority reported these</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">problems:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain: jenkins.my-domain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type:   dns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Detail: DNS problem: NXDOMAIN looking up A </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> jenkins.my-domain.com - check that a DNS record exists </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domain</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> DNS problem: NXDOMAIN looking up AAAA </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> jenkins.my-domain.com - check that a DNS record exists </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hint: The Certificate Authority failed to verify the temporary nginx configuration changes made by Certbot. Ensure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">the listed domains point to this nginx server and that it is accessible from the internet.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some challenges have failed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ask </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token builtin class-name">help</span><span class="token plain"> or search </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> solutions at https://community.letsencrypt.org. See the logfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/letsencrypt/letsencrypt.log or re-run Certbot with </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"> details.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This error is rather straightforward. After we delete the DNS record, we simply forgot to link the DNS record to
a new server/VM IP
:::</p>
<p>Remember the two paths from the command above: &quot;<strong>/path/to/server_crt.pem</strong>&quot; and &quot;<strong>/path/to/server_key.pem</strong>&quot;. We
will need them in order to <a href="#convert-ssl-keys-to-pkcs12-format">load certificate onto Jenkins instance</a> later. In
addition, under &quot;/path/to/&quot; there is also the CA certificate &quot;<strong>/path/to/cert.pem</strong>&quot;, which we will be using</p>
<p>:::tip <strong>Or</strong>, just get a certificate</p>
<p>If you&#x27;re feeling more conservative and would like to make the changes to the nginx configuration by hand, run this
command instead of the one above:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> certbot certonly </span><span class="token parameter variable" style="color:#36acaa">--nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>:::</p>
</li>
<li>
<p><strong>Test automatic renewal</strong> The Certbot packages on our system come with a cron job or systemd timer that will renew
our certificates automatically before they expire. We will not need to run Certbot again, unless we change our
configuration. We can test automatic renewal for our certificates by running this command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> certbot renew --dry-run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The command to renew certbot is installed in one of the following locations:</p><ul>
<li><code>/etc/crontab/</code></li>
<li><code>/etc/cron.*/*</code></li>
<li><code>systemctl list-timers</code></li>
</ul></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="convert-ssl-keys-to-pkcs12-format">Convert SSL keys to PKCS12 format<a href="#convert-ssl-keys-to-pkcs12-format" class="hash-link" aria-label="Direct link to Convert SSL keys to PKCS12 format" title="Direct link to Convert SSL keys to PKCS12 format">​</a></h4>
<p>When <a href="#generating-ssl-certificates">SSL is ready</a>, let&#x27;s enable secure connection to our Jenkins instance. We would need
the following files:</p>
<ol>
<li><code>server_crt.pem</code> - The signed certificate</li>
<li><code>server_key.pem</code> - The certificate key</li>
<li><code>cacert.pem</code> - The CA certificate</li>
</ol>
<p><strong><em>In the case of <a href="#self-signing-a-certificate">self-signed certificate</a></em></strong>, under <code>~/myCA</code> directory, execute</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl pkcs12 </span><span class="token parameter variable" style="color:#36acaa">-export</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> jenkins.p12 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">-passout</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pass:your-strong-password&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-inkey</span><span class="token plain"> server_key.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">-in</span><span class="token plain"> server_crt.pem </span><span class="token parameter variable" style="color:#36acaa">-certfile</span><span class="token plain"> cacert.pem </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> jenkins.some-domain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em><strong>In the case of <a href="#applying-for-a-certificate-using-certbot">publicly authorized certificate</a></strong></em>, run</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> openssl pkcs12 </span><span class="token parameter variable" style="color:#36acaa">-export</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> jenkins.p12 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-passout</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pass:your-strong-password&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-inkey</span><span class="token plain"> /path/to/server_key.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-in</span><span class="token plain"> /path/to/server_crt.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-certfile</span><span class="token plain"> /path/to/cert.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> jenkins.some-domain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>where <code>your-strong-password</code> would be a password of our choice; for example, if you choose &quot;sdfef3qxA&quot; as the password,
put <code>-passout &#x27;pass:sdfef3qxA&#x27;</code> there. Replace all the occurrences of &quot;your-secrete-password&quot; seen below with
&quot;sdfef3qxA&quot;. In adiition, <em>Replace &quot;jenkins.some-domain.com&quot; with our own CNAME</em></p>
<p>The command given above converts SSL certs to intermediate PKCS12 format named <strong>jenkins.p12</strong>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="convert-pkcs12-to-jks-format">Convert PKCS12 to JKS format<a href="#convert-pkcs12-to-jks-format" class="hash-link" aria-label="Direct link to Convert PKCS12 to JKS format" title="Direct link to Convert PKCS12 to JKS format">​</a></h4>
<p>Use the following keytool command to convert the <code>jenkins.p12</code> file to JKS format.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">keytool </span><span class="token parameter variable" style="color:#36acaa">-importkeystore</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-srckeystore</span><span class="token plain"> jenkins.p12 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">-srcstorepass</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;your-secret-password&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-srcstoretype</span><span class="token plain"> PKCS12 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">-srcalias</span><span class="token plain"> jenkins.some-domain.com </span><span class="token parameter variable" style="color:#36acaa">-deststoretype</span><span class="token plain"> JKS </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">-destkeystore</span><span class="token plain"> jenkins.jks </span><span class="token parameter variable" style="color:#36acaa">-deststorepass</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;your-secret-password&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">-destalias</span><span class="token plain"> jenkins.some-domain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Replace the following with our own values:</p>
<ul>
<li><code>-srcstorepass</code> - <a href="#convert-ssl-keys-to-pkcs12-format">The password we created above</a></li>
<li><code>-deststorepass</code> - A new password we created in this step</li>
<li><code>-srcalias</code> - The &quot;jenkins.some-domain.com&quot; or our own CNAME we used
<a href="#convert-ssl-keys-to-pkcs12-format">from the previous step</a></li>
<li><code>-destalias</code> - A destination CNAME, usually the same as <code>srcalias</code></li>
</ul>
<p>We should, after the command is executed, see a file named <strong>jenkins.jks</strong> in the current location.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="add-jks-to-jenkins-path">Add JKS to Jenkins Path<a href="#add-jks-to-jenkins-path" class="hash-link" aria-label="Direct link to Add JKS to Jenkins Path" title="Direct link to Add JKS to Jenkins Path">​</a></h4>
<p>The jenkins.jks file should be saved in a specific location where Jenkins can access it. Let&#x27;s create a folder for it
and move the jenkins.jks key to that location.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> /etc/jenkins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> jenkins.jks /etc/jenkins/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Change the permissions of the keys and folder.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-R</span><span class="token plain"> jenkins: /etc/jenkins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">700</span><span class="token plain"> /etc/jenkins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> /etc/jenkins/jenkins.jks</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>The <code>jenkins:</code> used in the first command is a standard Jenkins user that get&#x27;s created when we install
<a href="#long-term-support-release">Jenkins package</a>. We are essentially granting permission for that user here so do not
throw some other &quot;smart&quot; names there or change, please.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modify-jenkins-configuration-for-ssl">Modify Jenkins Configuration for SSL<a href="#modify-jenkins-configuration-for-ssl" class="hash-link" aria-label="Direct link to Modify Jenkins Configuration for SSL" title="Direct link to Modify Jenkins Configuration for SSL">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl edit jenkins</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">### Anything between here and the comment below will become the new contents of the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;JENKINS_PORT=-1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;JENKINS_HTTPS_PORT=443&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;JENKINS_HTTPS_KEYSTORE=/etc/jenkins/jenkins.jks&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;JENKINS_HTTPS_KEYSTORE_PASSWORD=&lt;some strong password&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;JENKINS_HTTPS_LISTEN_ADDRESS=0.0.0.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Lines below this comment will be discarded</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The config content above actually gets appended to the end of <code>systemctl cat jenkins</code> output, which we can verify to
make sure that the changes here actually propagates to Jenkins runtime.</p><p>Ignore the comments lines which starts with <code>### ...</code></p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="restart-jenkins">Restart Jenkins<a href="#restart-jenkins" class="hash-link" aria-label="Direct link to Restart Jenkins" title="Direct link to Restart Jenkins">​</a></h4>
<p>The restart command on Ubuntu C2 instance is</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl restart jenkins.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>which would probably fail, however, with the error</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl restart jenkins.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Job </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> jenkins.service failed because the control process exited with error code.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">See </span><span class="token string" style="color:#e3116c">&quot;systemctl status jenkins.service&quot;</span><span class="token plain"> and </span><span class="token string" style="color:#e3116c">&quot;journalctl -xeu jenkins.service&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> details.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Whenever Jenkins control failes with <code>systemctl</code>, we can use its diagnosing command <code>journalctl</code> to further investigate:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">journalctl </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> jenkins.service </span><span class="token parameter variable" style="color:#36acaa">-r</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>which probably would show us the follwoing error</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Caused: java.io.IOException: Failed to </span><span class="token builtin class-name">bind</span><span class="token plain"> to /0.0.0.0:443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at org.eclipse.jetty.server.ServerConnector.openAcceptChannel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ServerConnector.java:339</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.base/sun.nio.ch.ServerSocketChannelImpl.bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ServerSocketChannelImpl.java:227</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.base/sun.nio.ch.Net.bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Net.java:448</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.base/sun.nio.ch.Net.bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Net.java:459</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.base/sun.nio.ch.Net.bind0</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Native Method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.net.SocketException: Permission denied</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is because Jetty, which is the Jenkins server, does not have sudo permission to listen on SSL port 443 on startup.
We could verify this by having Jenkins SSL port listen on a non-sudo port such as 8443. To do so, we will run</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl edit jenkins</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>again and change the line from</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;JENKINS_HTTPS_PORT=443&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>to</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;JENKINS_HTTPS_PORT=8443&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We will see that Jenkins process started:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-aux</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> jenkins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jenkins    </span><span class="token number" style="color:#36acaa">46742</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45.1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99.1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3245534</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">89876543</span><span class="token plain"> ?      Ssl  06:12   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:29 /usr/bin/java </span><span class="token parameter variable" style="color:#36acaa">-Djava.awt.headless</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true </span><span class="token parameter variable" style="color:#36acaa">-jar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/java/jenkins.war </span><span class="token parameter variable" style="color:#36acaa">--webroot</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/var/cache/jenkins/war </span><span class="token parameter variable" style="color:#36acaa">--httpPort</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">-1 </span><span class="token parameter variable" style="color:#36acaa">--httpsPort</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8443</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--httpsListenAddress</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">--httpsKeyStore</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/etc/jenkins/jenkins.jks </span><span class="token parameter variable" style="color:#36acaa">--httpsKeyStorePassword</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">**************</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We have 2 options.</p>
<ol>
<li>Instruct <code>sudo systemctl restart jenkins.service</code> to execute the command above with <code>sudo</code></li>
<li>Simply add an inbound rule to AWS EC2 security group to have Jenkins HTTPS listen on a port greater than 1024</li>
</ol>
<p>We would go with the 2nd option in this post. If we want to open the port for HTTPS and it&#x27;s not 443, then in addition
to adding HTTPS rule, we could also just add a &quot;Custom TCP&quot; rule for the desired port (i.e. 8443) and it will work.</p>
<p>Now we should be able to access Jenkins over HTTPS with port 8443 at <code>https://jenkins.some-domain.com:8443</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="https-via-nginx-reverse-proxy">HTTPS via Nginx Reverse Proxy<a href="#https-via-nginx-reverse-proxy" class="hash-link" aria-label="Direct link to HTTPS via Nginx Reverse Proxy" title="Direct link to HTTPS via Nginx Reverse Proxy">​</a></h4>
<p>Proxying is typically used to distribute the load among several servers, seamlessly show content from different
websites, or pass requests for processing to application servers over protocols other than HTTP.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>What Is a Reverse Proxy Server?</div><div class="admonitionContent_BuS1"><p>A proxy server is a go‑between or intermediary server that forwards requests for content from multiple clients to
different servers across the Internet. A <strong>reverse proxy server</strong> is a type of proxy server that typically sits behind
the firewall in a private network and directs client requests to the appropriate backend server. A reverse proxy
provides an additional level of abstraction and control to ensure the smooth flow of network traffic between clients and
servers.</p><p>Common uses for a reverse proxy server include:</p><ul>
<li><strong>Load balancing</strong> A reverse proxy server can act as a &quot;traffic cop&quot; sitting in front of backend servers and
distributing client requests across a group of servers in a manner that maximizes speed and capacity utilization
while ensuring no one server is overloaded, which can degrade performance. If a server goes down, the load balancer
redirects traffic to the remaining online servers.</li>
<li><strong>Web acceleration</strong> Reverse proxies can compress inbound and outbound data, as well as cache commonly requested
content, both of which speed up the flow of traffic between clients and servers. They can also perform additional
tasks such as SSL encryption to take load off of your web servers, thereby boosting their performance.</li>
<li><strong>Security &amp; Anonymity</strong> By intercepting requests headed for your backend servers, a reverse proxy server protects
their identities and acts as an additional defense against security attacks. It also ensures that multiple servers can
be accessed from a single record locator or URL regardless of the structure of your local area network.</li>
</ul></div></div>
<p><img loading="lazy" alt="Error loading nginx-directives.png" src="/assets/images/nginx-directives-30dbdbddf077199d400879319068b9a9.png" width="1023" height="512" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-nginx-configuration-file-structure-and-configuration-contexts">Understanding the Nginx Configuration File Structure and Configuration Contexts<a href="#understanding-the-nginx-configuration-file-structure-and-configuration-contexts" class="hash-link" aria-label="Direct link to Understanding the Nginx Configuration File Structure and Configuration Contexts" title="Direct link to Understanding the Nginx Configuration File Structure and Configuration Contexts">​</a></h5>
<p>While we know Certbot utilizes Nginx&#x27;s capabilities, people are often confused by some of the conventions they find in
Nginx configuration files. In this section, we will focus first on the basic structure of an Nginx configuration file.</p>
<p>The main Nginx configuration file is located at &quot;<strong>/etc/nginx/nginx.conf</strong>&quot; in our EC2 Ubuntu instance.</p>
<p>One of the first things that we should notice when looking at the main configuration file is that it appears to be
organized in a tree-like structure, defined by sets of brackets (that look like <code>{</code> and <code>}</code>). In Nginx parlance, the
areas that these brackets define are called “contexts” because they contain configuration details that are separated
according to their area of concern. Basically, these divisions provide an organizational structure along with some
conditional logic to decide whether to apply the configurations within.</p>
<p>Because contexts can be layered within one another, Nginx provides a level of directive inheritance. As a general rule,
if a directive is valid in multiple nested scopes, a declaration in a broader context will be passed on to any child
contexts as default values. The children contexts can override these values at will. It is worth noting that an override
to any array-type directives will replace the previous value, not append to it.</p>
<p>Directives can only be used in the contexts that they were designed for. Nginx will error out on reading a configuration
file with directives that are declared in the wrong context. The
<a href="http://nginx.org/en/docs/dirindex.html" target="_blank" rel="noopener noreferrer">Nginx documentation</a> contains information about which contexts each directive
is valid in, so it is a great reference if you are unsure.</p>
<p>Next, we&#x27;ll discuss the most common contexts in Nginx.</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="the-main-context">The Main Context<a href="#the-main-context" class="hash-link" aria-label="Direct link to The Main Context" title="Direct link to The Main Context">​</a></h6>
<p>The most general context is the &quot;main&quot; or &quot;global&quot; context. It is the only context that is not contained within the
typical context blocks that look like this:</p>
<div class="language-config codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-config codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># The main context is here, outside any other contexts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">. . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    . . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Any directive that exist entirely outside of these blocks is said to inhabit the &quot;main&quot; context. Keep in mind that if
our Nginx configuration is set up in a modular fashion, some files will contain instructions that appear to exist
outside of a bracketed context, but which will be included within such a context when the configuration is stitched
together.</p>
<p>The main context represents the broadest environment for Nginx configuration. It is used to configure details that
affect the entire application on a basic level. While the directives in this section affect the lower contexts, many of
these aren&#x27;t inherited because they cannot be overridden in lower levels.</p>
<p>Some common details that are configured in the main context are the user and group to run the worker processes as, the
number of workers, and the file to save the main process&#x27;s PID. We can even define things like worker CPU affinity and
the &quot;niceness&quot; of worker processes. The default error file for the entire application can be set at this level (this can
be overridden in more specific contexts).</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="the-events-context">The Events Context<a href="#the-events-context" class="hash-link" aria-label="Direct link to The Events Context" title="Direct link to The Events Context">​</a></h6>
<p>The &quot;events&quot; context is contained within the &quot;main&quot; context. It is used to set global options that affect how Nginx
<strong>handles connections</strong> at a general level. There can only be a single events context defined within the Nginx
configuration.</p>
<p>This context will look like this in the configuration file, outside of any other bracketed contexts:</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># main context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">events {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # events context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    . . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Nginx uses an event-based connection processing model, so the directives defined within this context determine how
worker processes should handle connections. Mainly, directives found here are used to either select the connection
processing technique to use, or to modify the way these methods are implemented.</p>
<p>Usually, the connection processing method is automatically selected based on the most efficient choice that the platform
has available. For Linux systems, the <em>epoll</em> method is usually the best choice.</p>
<p>Other items that can be configured are the number of connections each worker can handle, whether a worker will only take
a single connection at a time or take all pending connections after being notified about a pending connection, and
whether workers will take turns responding to events.</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="the-http-context">The HTTP Context<a href="#the-http-context" class="hash-link" aria-label="Direct link to The HTTP Context" title="Direct link to The HTTP Context">​</a></h6>
<p>When configuring Nginx as a web server or <strong>reverse proxy</strong>, the &quot;http&quot; context will hold the majority of the
configuration. This context will contain all of the directives and other contexts necessary to define how the program
will handle HTTP or <strong>HTTPS</strong> connections.</p>
<p>The http context is a sibling of the events context, so they should be listed side-by-side, rather than nested. They
both are children of the main context:</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># main context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">events {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # events context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    . . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # http context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    . . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>While lower contexts get more specific about how to handle requests, directives at this level control the defaults for
every virtual server defined within. A large number of directives are configurable at this context and below, depending
on how we would like the inheritance to function.</p>
<p>Some of the directives that we are likely to encounter control the default locations for access and error logs
(<strong>access_log</strong> and <strong>error_log</strong>), configure asynchronous I/O for file operations (aio, sendfile, and directio), and
configure the server&#x27;s statuses when errors occur (error_page). Other directives configure compression (gzip and
gzip_disable), fine-tune the TCP keep alive settings (<strong>keepalive_disable</strong>, <strong>keepalive_requests</strong>, and
<strong>keepalive_timeout</strong>), and the rules that Nginx will follow to try to optimize packets and system calls (sendfile,
tcp_nodelay, and tcp_nopush). Additional directives configure an application-level document root and index files (root
and index) and set up the various hash tables that are used to store different types of data (*_hash_bucket_size and
*_hash_max_size for server_names, types, and variables).</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="the-server-context">The Server Context<a href="#the-server-context" class="hash-link" aria-label="Direct link to The Server Context" title="Direct link to The Server Context">​</a></h6>
<p>The &quot;server&quot; context is declared within the &quot;http&quot; context. This is our first example of nested, bracketed contexts. It
is also the first context that allows for multiple declarations.</p>
<p>The general format for server context may look something like this. Remember that these reside within the http context:</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># main context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # http context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # first server context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # second server context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The reason for allowing multiple declarations of the server context is that <strong>each instance defines a specific virtual
server to handle client requests</strong>. You can have as many server blocks as you need, each of which can handle a specific
subset of connections.</p>
<p>Due to the possibility and likelihood of multiple server blocks, this context type is also the first that Nginx must use
a selection algorithm to make decisions. Each client request will be handled according to the configuration defined in a
single server context, so Nginx must decide which server context is most appropriate based on details of the request.
The directives which decide if a server block will be used to answer a request are:</p>
<ul>
<li><strong>listen</strong>: The <em>IP:port</em> combination that this server block is designed to respond to. If a request is made by a
client that matches these values, this block will potentially be selected to handle the connection.</li>
<li><strong>server_name</strong>: This directive is the other component used to select a server block for processing. If there are
multiple server blocks with listen directives of the same specificity that can handle the request, Nginx will parse
the &quot;Host&quot; header of the request and match it against this directive.</li>
</ul>
<p>The directives in this context can override many of the directives that may be defined in the http context, including
logging, the document root, compression, etc. In addition to the directives that are taken from the http context, we
also can configure files to try to respond to requests (try_files), issue redirects and rewrites (return and rewrite),
and set arbitrary variables (set).</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="the-location-context">The Location Context<a href="#the-location-context" class="hash-link" aria-label="Direct link to The Location Context" title="Direct link to The Location Context">​</a></h6>
<p>The next context that we will deal with regularly is the location context. Location contexts share many relational
qualities with server contexts. For example, multiple location contexts can be defined, each location is used to handle
a certain type of client request, and each location is selected by virtue of matching the location definition against
the client request through a selection algorithm.</p>
<p>While the directives that determine whether to select a server block are defined within the server context, the
component that decides on a location&#x27;s ability to handle a request is located in the location definition (the line that
opens the location block).</p>
<p>The general syntax looks like this:</p>
<div class="language-config codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-config codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location match_modifier location_match {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    . . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Location blocks live within server contexts and, unlike server blocks, can be nested inside one another. This can be
useful for creating a more general location context to catch a certain subset of traffic, and then further processing it
based on more specific criteria with additional contexts inside:</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># main context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # server context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /match/criteria {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # first location context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /other/criteria {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # second location context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location nested_match {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            # first nested location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location other_nested {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            # second nested location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>While server contexts are selected based on the requested IP address/port combination and the host name in the &quot;Host&quot;
header, location blocks further divide up the request handling within a server block by looking at the request URI. The
request URI is the portion of the request that comes after the domain name or IP address/port combination.</p>
<p>For example, if a client requests <code>http://www.example.com/blog</code> on port 80, the <code>http</code>, <code>www.example.com</code>, and port 80
would all be used to determine which server block to select. After a server is selected, the &quot;/blog&quot; portion (the
request URI), would be evaluated against the defined locations to determine which further context should be used to
respond to the request.</p>
<p>Many of the directives you are likely to see in a location context are also available at the parent levels. New
directives at this level allow you to reach locations outside of the document root (alias), mark the location as only
internally accessible (internal), and proxy to other servers or locations (using http, fastcgi, scgi, and uwsgi
proxying).</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="how-certbot--nginx-enable-ssl">How Certbot + Nginx Enable SSL<a href="#how-certbot--nginx-enable-ssl" class="hash-link" aria-label="Direct link to How Certbot + Nginx Enable SSL" title="Direct link to How Certbot + Nginx Enable SSL">​</a></h5>
<p>Recall that we have made our Jenkins instance available at <code>https://jenkins.some-domain.com:8443</code> with a port number of
&quot;8443&quot;. If we would like to get rid of it and simply visit Jenkins at <code>https://jenkins.some-domain.com</code>, we will add an
redirect to Certbot-managed Nginx config at <strong>/etc/nginx/sites-enabled/default</strong>:</p>
<div class="language-config codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-config codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_pass https://localhost:8443;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen [::]:443 ssl ipv6only=on;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen 443 ssl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ssl_certificate ...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ssl_certificate_key ...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note the proxying rule of <code>proxy_pass https://localhost:8443;</code>. If, instead, we have some other app that runs on top of
HTTP only (with port 8080 for example) while our EC2 host has SSL certificate, we would simply have our EC2 instance
taking care of all the SSL stuff and proxy all HTTPS request to the HTTP app via <code>proxy_pass http://localhost:8080;</code></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>We may need to restart EC2 instance for the change above to take effect</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="post-installation-setup-wizard">Post-Installation Setup Wizard<a href="#post-installation-setup-wizard" class="hash-link" aria-label="Direct link to Post-Installation Setup Wizard" title="Direct link to Post-Installation Setup Wizard">​</a></h3>
<p>After downloading, installing and running Jenkins on SSL, the post-installation setup wizard begins.</p>
<p>The setup wizard takes us through a few quick &quot;one-off&quot; steps to unlock Jenkins, customize it with plugins and create
the first administrator user through which we can continue accessing Jenkins.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="unlocking-jenkins">Unlocking Jenkins<a href="#unlocking-jenkins" class="hash-link" aria-label="Direct link to Unlocking Jenkins" title="Direct link to Unlocking Jenkins">​</a></h4>
<p>When we first access a new Jenkins instance, we are asked to unlock it using an automatically-generated password. Browse
to <code>https://jenkins.my-domain.com:8443</code> and wait until the Unlock Jenkins page appears.</p>
<p><img loading="lazy" alt="Error loading unlock-jenkins.png" src="/assets/images/unlock-jenkins-b0765375d1d16daed87f0938c9e962ab.png" width="1239" height="783" class="img_ev3q"></p>
<p>As prompted, enter the password found in <strong>/var/lib/jenkins/secrets/initialAdminPassword</strong> on our EC2 instance path. Use
the following command to display this password:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ec2-user ~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /var/lib/jenkins/secrets/initialAdminPassword</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>On the Unlock Jenkins page, paste this password into the <strong>Administrator password</strong> field and click <strong>Continue</strong>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This password also serves as the default administrator account&#x27;s password (with username &quot;admin&quot;) if we happen to skip
the subsequent user-creation step in the setup wizard (So, DO NOT skip this subsequent step).</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="customizing-jenkins-with-plugins">Customizing Jenkins with Plugins<a href="#customizing-jenkins-with-plugins" class="hash-link" aria-label="Direct link to Customizing Jenkins with Plugins" title="Direct link to Customizing Jenkins with Plugins">​</a></h4>
<p>After <a href="#unlocking-jenkins">unlocking Jenkins</a>, the Customize Jenkins page appears. Here we can install any number of
useful plugins as part of our initial setup.</p>
<p>Click one of the two options shown:</p>
<ul>
<li><strong>Install suggested plugins</strong> - to install the recommended set of plugins, which are based on most common use cases.</li>
<li><strong>Select plugins to install</strong> - to choose which set of plugins to initially install. When we first access the plugin
selection page, the suggested plugins are selected by default.</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If we are not sure what plugins we need, choose <strong>Install suggested plugins</strong>. We can install (or remove) additional
Jenkins plugins at a later point in time via the
<a href="https://www.jenkins.io/doc/book/managing/" target="_blank" rel="noopener noreferrer"><strong>Manage Jenkins</strong></a> &gt;
<a href="https://www.jenkins.io/doc/book/managing/plugins/" target="_blank" rel="noopener noreferrer"><strong>Manage Plugins page in Jenkins</strong></a>.</p></div></div>
<p>The setup wizard shows the progression of Jenkins being configured and our chosen set of Jenkins plugins being
installed. This process may take a few minutes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-first-administrator-user">Creating the First Administrator User<a href="#creating-the-first-administrator-user" class="hash-link" aria-label="Direct link to Creating the First Administrator User" title="Direct link to Creating the First Administrator User">​</a></h4>
<p><img loading="lazy" alt="Error loading create-admin-user.png" src="/assets/images/create-admin-user-ed93c763ea1cd4ba645b1bcebb910f77.png" width="1242" height="784" class="img_ev3q"></p>
<p>Finally, after <a href="#customizing-jenkins-with-plugins">customizing Jenkins with plugins</a>, Jenkins asks us to create our
first administrator user.</p>
<ol>
<li>
<p>When the <strong>Create First Admin User</strong> page appears, specify the details for our administrator user in the respective
fields and click <strong>Save and Finish</strong>.</p>
</li>
<li>
<p>When the <strong>Jenkins is ready</strong> page appears, click <strong>Start using Jenkins</strong>.</p>
<ul>
<li>This page may indicate <strong>Jenkins is almost ready!</strong> instead and if so, click <strong>Restart</strong>.</li>
<li>If the page does not automatically refresh after a minute, use our web browser to refresh the page manually.</li>
</ul>
</li>
<li>
<p>If required, log in to Jenkins with the credentials of the user we just created and we are ready to start using
Jenkins!</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-permission-error-when-trigger-by-jenkins">Docker Permission Error When Trigger by Jenkins<a href="#docker-permission-error-when-trigger-by-jenkins" class="hash-link" aria-label="Direct link to Docker Permission Error When Trigger by Jenkins" title="Direct link to Docker Permission Error When Trigger by Jenkins">​</a></h3>
<p>When a job <strong>Build Steps</strong> contains Shell Execution which includes some Docker command, it might fail with</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Got permission denied </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Post </span><span class="token string" style="color:#e3116c">&quot;...&quot;</span><span class="token builtin class-name">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dial unix /var/run/docker.sock: connect: permission denied</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The user &quot;jenkins&quot; needs to be added to the group docker:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-G</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> jenkins</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then restart Jenkins. (and reboot server if not working)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="echo-off-in-jenkins-console-output">Echo Off in Jenkins Console Output<a href="#echo-off-in-jenkins-console-output" class="hash-link" aria-label="Direct link to Echo Off in Jenkins Console Output" title="Direct link to Echo Off in Jenkins Console Output">​</a></h3>
<p>By default, Jenkins launches Execute Shell script with <code>set -x</code>. This causes all commands to be echoed. We can type
<code>set +x</code> before any command to temporary override that behavior. Of course you will need <code>set -x</code> to start showing them
again.</p>
<p>You can override this behaviour for the whole script by putting the following at the top of the build step:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/bash +x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/jenkins">Jenkins</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/QubitPi/hashicorp-aws/tree/master/docs/blog/2022-10-31-jenkins-on-aws/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/nvm"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Switching Node.js Versions with NVM</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/aws-troubleshooting"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">AWS Troubleshooting</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-a-key-pair" class="table-of-contents__link toc-highlight">Creating a Key Pair</a></li><li><a href="#creating-a-security-group" class="table-of-contents__link toc-highlight">Creating a Security Group</a></li><li><a href="#launching-an-amazon-ec2-instance" class="table-of-contents__link toc-highlight">Launching an Amazon EC2 Instance</a></li><li><a href="#installing-jenkins-on-ec2" class="table-of-contents__link toc-highlight">Installing Jenkins on EC2</a><ul><li><a href="#connecting-to-our-linux-instance" class="table-of-contents__link toc-highlight">Connecting to Our Linux Instance</a></li><li><a href="#downloading-and-installing-jenkins" class="table-of-contents__link toc-highlight">Downloading and Installing Jenkins</a></li></ul></li><li><a href="#enable-ssl-on-jenkins-server-ubuntu" class="table-of-contents__link toc-highlight">Enable SSL on Jenkins Server (Ubuntu)</a><ul><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li><li><a href="#about-openssl" class="table-of-contents__link toc-highlight">About OpenSSL</a></li><li><a href="#installing-openssl-toolkit" class="table-of-contents__link toc-highlight">Installing OpenSSL Toolkit</a></li><li><a href="#generating-ssl-certificates" class="table-of-contents__link toc-highlight">Generating SSL Certificates</a></li><li><a href="#post-installation-setup-wizard" class="table-of-contents__link toc-highlight">Post-Installation Setup Wizard</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#docker-permission-error-when-trigger-by-jenkins" class="table-of-contents__link toc-highlight">Docker Permission Error When Trigger by Jenkins</a></li><li><a href="#echo-off-in-jenkins-console-output" class="table-of-contents__link toc-highlight">Echo Off in Jenkins Console Output</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Documentations</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/hashicorp-aws" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/QubitPi/hashicorp-aws" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Jiaqi Liu. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>