"use strict";(self.webpackChunkhashicorp_aws=self.webpackChunkhashicorp_aws||[]).push([[8471],{6183:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>h,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var s=n(3860),a=n(5639),t=n(6298),r=n(79);const l={sidebar_position:1,title:"General Deployment"},o="Deploying Jersey-Jetty Based Webservice",c={id:"webservice/index",title:"General Deployment",description:"Deploying Jersey-Jetty Based Webservice",source:"@site/docs/webservice/index.mdx",sourceDirName:"webservice",slug:"/webservice/",permalink:"/docs/webservice/",draft:!1,unlisted:!1,editUrl:"https://github.com/QubitPi/hashicorp-aws/tree/master/docs/docs/webservice/index.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"General Deployment"},sidebar:"tutorialSidebar",previous:{title:"Webservice",permalink:"/docs/category/webservice"},next:{title:"Deployment via GitHub Actions",permalink:"/docs/webservice/github-actions"}},h={},d=[{value:"General Deployments",id:"general-deployments",level:2},{value:"Defining Packer Variables",id:"defining-packer-variables",level:3},{value:"Defining Terraform Variables",id:"defining-terraform-variables",level:3},{value:"Building AMI Image",id:"building-ami-image",level:3},{value:"Deploying to EC2",id:"deploying-to-ec2",level:3},{value:"Deployment via Screwdriver CD",id:"deployment-via-screwdriver-cd",level:2},{value:"Deployment via GitHub Actions",id:"deployment-via-github-actions",level:2},{value:"Deployment via HACP",id:"deployment-via-hacp",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"AWS",id:"aws",level:3},{value:"The Webservice was Running Properly Right After Deployment, but NOT After a While with &quot;503 Service Unavailable&quot;",id:"the-webservice-was-running-properly-right-after-deployment-but-not-after-a-while-with-503-service-unavailable",level:4}];function u(e){const i={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.h1,{id:"deploying-jersey-jetty-based-webservice",children:"Deploying Jersey-Jetty Based Webservice"}),"\n",(0,s.jsx)(i.admonition,{type:"tip",children:(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Yes, we DO NOT support Spring, never ever"}),"\n",(0,s.jsxs)(i.li,{children:["EBS volumes during build time will ",(0,s.jsx)(i.a,{href:"https://packer.qubitpi.org/packer/integrations/hashicorp/amazon/latest/components/builder/ebs#:~:text=Optional%3A-,delete_on_termination,-(bool)%20%2D%20Indicates%20whether",children:"automatically be removed"})]}),"\n"]})}),"\n",(0,s.jsx)(i.p,{children:"Immutable Webservice by hashicorp-aws supports 2 deployment modes:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"SSL/HTTPS"}),"\n",(0,s.jsx)(i.li,{children:"non-SSL/HTTPS"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["The first mode is very suitable for MVP such as a web app backed by a single webservice. The second mode is designed for\n",(0,s.jsx)(i.a,{href:"https://dev.to/behalf/authentication-authorization-in-microservices-architecture-part-i-2cn0#global-authentication-api-gateway-and-authorization-per-service",children:"microservices architecture where authentication is delegated to an API gateway"})]}),"\n",(0,s.jsx)(i.h2,{id:"general-deployments",children:"General Deployments"}),"\n",(0,s.jsx)(i.admonition,{type:"info",children:(0,s.jsxs)(i.p,{children:["Please complete the ",(0,s.jsx)(i.a,{href:"setup#setup",children:"general setup"})," before proceeding. If you are deploying in ",(0,s.jsx)(i.em,{children:"non-SSL/HTTPS mode"}),", the\n",(0,s.jsx)(i.a,{href:"setup#optional-setup-ssl",children:"SSL section"})," can be skipped."]})}),"\n",(0,s.jsx)(i.admonition,{title:"Nginx Config in SSL/HTTPS mode",type:"tip",children:(0,s.jsxs)(i.p,{children:["We offer a ",(0,s.jsx)(i.a,{href:"setup#optional-setup-ssl",children:"Nginx config file"})," template.\n",(0,s.jsx)(i.a,{href:"https://github.com/QubitPi/hashicorp-aws/blob/master/hashicorp/webservice/images/ssl/nginx-ssl.conf",children:"This template"}),"\nwill be used by hashicorp-aws by default"]})}),"\n",(0,s.jsx)(i.h3,{id:"defining-packer-variables",children:"Defining Packer Variables"}),"\n",(0,s.jsxs)(i.p,{children:["Create a ",(0,s.jsx)(i.a,{href:"https://packer.qubitpi.org/packer/guides/hcl/variables#from-a-file",children:"HashiCorp Packer variable values file"})," named ",(0,s.jsx)(i.strong,{children:"aws-ws.auto.pkrvars.hcl"})," under one of the subdirectory of\n",(0,s.jsx)(i.strong,{children:(0,s.jsx)(i.a,{href:"https://github.com/QubitPi/hashicorp-aws/tree/master/hashicorp/webservice/images",children:"hashicorp-aws/hashicorp/webservice/images"})}),", depending on the deployment mode, with the following contents:"]}),"\n",(0,s.jsxs)(t.Z,{children:[(0,s.jsxs)(r.Z,{value:"non-ssl",label:"non-SSL/HTTPS",default:!0,children:[(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-hcl",metastring:"title=hashicorp-aws/hashicorp/webservice/images/basic/aws-aws.auto.pkrvars.hcl",children:'ami_region                   = "my-aws-region"\nami_name                     = "my-webservice"\ninstance_type                = "<one of t2.micro/t2.small/t2.medium/t2.large/t2.xlarge/t2.2xlarge>"\nws_war_path                  = "my-webservice-1.0-SNAPSHOT.war"\nws_filebeat_config_file_path = "filebeat.yml"\n'})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ami_region"})," is the ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html#Concepts.RegionsAndAvailabilityZones.Availability",children:"region"})," where webservice ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html",children:"AMI"})," will be published to. The published\nimage will be ",(0,s.jsx)(i.em,{children:"private"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ami_name"})," is the name of the resulting AMI that will appear when managing AMIs in the AWS console or via APIs. This\ncan be the same across builds, because hashicorp-aws will deregister the old AMI with the same name and replace it\nwith the current built one"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"instance_type"})," is the ",(0,s.jsx)(i.a,{href:"https://aws.amazon.com/ec2/instance-types/",children:"EC2 instance type"})," to use while building the AMI, such as t2.small."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ws_war_path"})," is the absolute path or the path relative to ",(0,s.jsx)(i.code,{children:"hashicorp-aws/hashicorp/webservice/images/basic"})," of\nthe webservice WAR file we are going to deploy"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ws_filebeat_config_file_path"})," is the absolute path or the path relative to\n",(0,s.jsx)(i.code,{children:"hashicorp-aws/hashicorp/webservice/images/basic"})," of the filebeat config file if the webservice is sending logs\nto ELK"]}),"\n",(0,s.jsx)(i.admonition,{type:"tip",children:(0,s.jsx)(i.p,{children:"It is very important to connect webservice to an external logging & auditing service like ELK, because once\nwebservice is deployed as an immutable infrastructure, it is completely sealed in a sense that no one can SSH into\nit. This means logs or other metrics are not available unless they are send to an external logging & auditing\nservice such as ELK. Our HACP offers out-of-the box deployment of ELK and allow the webservice to automatically\nconnect to it to send logs and metrics, which gives us a lot better experience on working with webservice logging\n& auditing."})}),"\n"]}),"\n"]})]}),(0,s.jsxs)(r.Z,{value:"ssl",label:"SSL/HTTPS",children:[(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-hcl",metastring:"title=hashicorp-aws/hashicorp/webservice/images/ssl/aws-aws.auto.pkrvars.hcl",children:'ami_region                    = "my-aws-region"\nami_name                      = "my-webservice"\ninstance_type                 = "<one of t2.micro/t2.small/t2.medium/t2.large/t2.xlarge/t2.2xlarge>"\nws_war_path                   = "my-webservice-1.0-SNAPSHOT.war"\nws_filebeat_config_file_path  = "filebeat.yml"\naws_ws_ssl_cert_file_path     = "server.crt"\naws_ws_ssl_cert_key_file_path = "server.key"\n'})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ami_region"})," is the ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html#Concepts.RegionsAndAvailabilityZones.Availability",children:"region"})," where webservice ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html",children:"AMI"})," will be published to. The\npublished image will be ",(0,s.jsx)(i.em,{children:"private"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ami_name"})," is the published ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html",children:"AMI"})," name; it can be arbitrary"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"instance_type"})," is the ",(0,s.jsx)(i.a,{href:"https://aws.amazon.com/ec2/instance-types/",children:"EC2 instance type"})," to use while building the AMI, such as t2.small."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ws_war_path"})," is the absolute path or the path relative to ",(0,s.jsx)(i.code,{children:"hashicorp-aws/hashicorp/webservice/images/basic"})," of\nthe webservice WAR file we are going to deploy"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ws_filebeat_config_file_path"})," is the absolute path or the path relative to\n",(0,s.jsx)(i.code,{children:"hashicorp-aws/hashicorp/webservice/images/ssl"})," of the filebeat config file if the webservice is sending logs\nto ELK"]}),"\n",(0,s.jsx)(i.admonition,{type:"tip",children:(0,s.jsx)(i.p,{children:"It is very important to connect webservice to an external logging & auditing service like ELK, because once\nwebservice is deployed as an immutable infrastructure, it is completely sealed in a sense that no one can SSH into\nit. This means logs or other metrics are not available unless they are send to an external logging & auditing\nservice such as ELK. Our HACP offers out-of-the box deployment of ELK and allow the webservice to automatically\nconnect to it to send logs and metrics, which gives us a lot better experience on working with webservice logging\n& auditing."})}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"aws_ws_ssl_cert_file_path"})," is the absolute path or the path relative to ",(0,s.jsx)(i.code,{children:"hashicorp-aws/hashicorp/aws/images/ssl"}),"\nof the ",(0,s.jsx)(i.a,{href:"setup#optional-setup-ssl",children:"SSL certificate file"})," for the webservice API domain"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"aws_ws_ssl_cert_key_file_path"}),"  is the absolute path or the path relative to\n",(0,s.jsx)(i.code,{children:"hashicorp-aws/hashicorp/webservice/images/ssl"})," of the ",(0,s.jsx)(i.a,{href:"setup#optional-setup-ssl",children:"SSL certificate key file"})," for the webservice\nAPI domain"]}),"\n"]}),"\n"]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"defining-terraform-variables",children:"Defining Terraform Variables"}),"\n",(0,s.jsxs)(i.p,{children:["Create a ",(0,s.jsx)(i.a,{href:"https://terraform.qubitpi.org/terraform/language/values/variables#variable-definitions-tfvars-files",children:"HashiCorp Terraform variable values file"})," named ",(0,s.jsx)(i.strong,{children:"aws-ws.auto.tfvars"})," under one of the subdirectory of\n",(0,s.jsx)(i.strong,{children:"[hashicorp-aws/hashicorp/webservice/instances]"}),", depending on the deployment mode, with the following contents:"]}),"\n",(0,s.jsxs)(t.Z,{children:[(0,s.jsxs)(r.Z,{value:"non-ssl",label:"non-SSL/HTTPS",default:!0,children:[(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-hcl",metastring:"title=hashicorp-aws/hashicorp/webservice/instances/basic/aws-ws.auto.tfvars",children:'aws_ec2_region = "my-aws-region"\nami_name          = "my-webservice"\ninstance_type     = "<one of t2.micro/t2.small/t2.medium/t2.large/t2.xlarge/t2.2xlarge>"\nec2_instance_name = "My Webservice"\nsecurity_groups   = ["My Webservice"]\n'})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"aws_ec2_region"})," is the ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html#Concepts.RegionsAndAvailabilityZones.Availability",children:"EC2 runtime region"})]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"ami_name"})," is the name of the published AMI; ",(0,s.jsxs)(i.strong,{children:["it must be the same as the ",(0,s.jsx)(i.code,{children:"ami_name"})," in\n",(0,s.jsx)(i.a,{href:"#defining-packer-variables",children:"Packer variable file"})]})]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"instance_type"})," is the ",(0,s.jsx)(i.a,{href:"https://aws.amazon.com/ec2/instance-types/",children:"AWS EC2 instance type"})," used for deployed infrastructure"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"ec2_instance_name"})," is the deployed EC2 name as appeared in the instance list of AWS console; it can be arbitrary"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"security_groups"})," is the list of ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-groups.html",children:"AWS Security Group"})," ",(0,s.jsx)(i.em,{children:"names"})," to associate with (yes, not ID, but name...)"]}),"\n"]})]}),(0,s.jsxs)(r.Z,{value:"ssl",label:"SSL/HTTPS",children:[(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-hcl",metastring:"title=hashicorp-aws/hashicorp/webservice/instances/ssl/aws-ws.auto.tfvars",children:'aws_ec2_region = "my-aws-region"\nami_name          = "my-webservice"\ninstance_type     = "<one of t2.micro/t2.small/t2.medium/t2.large/t2.xlarge/t2.2xlarge>"\nec2_instance_name = "My Webservice"\nsecurity_groups   = ["My Webservice"]\nroute_53_zone_id  = "9DQXLTNSN7ZX9P8V2KZII"\nws_domain         = "mywebservice.mycompany.com"\n'})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"aws_ec2_region"})," is the ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html#Concepts.RegionsAndAvailabilityZones.Availability",children:"EC2 runtime region"})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ami_name"})," is the name of the published AMI; ",(0,s.jsxs)(i.strong,{children:["it must be the same as the ",(0,s.jsx)(i.code,{children:"ami_name"})," in\n",(0,s.jsx)(i.a,{href:"#defining-packer-variables",children:"Packer variable file"})]})]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"instance_type"})," is the ",(0,s.jsx)(i.a,{href:"https://aws.amazon.com/ec2/instance-types/",children:"AWS EC2 instance type"})," used for deployed infrastructure"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ec2_instance_name"})," is the deployed EC2 name as appeared in the instance list of AWS console; it can be arbitrary"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"security_groups"})," is the list of ",(0,s.jsx)(i.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-groups.html",children:"AWS Security Group"})," ",(0,s.jsx)(i.em,{children:"names"})," to associate with (yes, not ID, but name...)"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"ws_domain"})," is the SSL-enabled domain that will serve webservice API URL"]}),"\n",(0,s.jsx)(i.admonition,{type:"warning",children:(0,s.jsxs)(i.p,{children:["Although the ",(0,s.jsx)(i.code,{children:"ws_domain"})," is a public identity, hashicorp-aws will bind a ",(0,s.jsx)(i.strong,{children:"private IP"})," address to this domain,\nbecause webservice tend to be deployed in a virtual private network and AWS also requires\n",(0,s.jsx)(i.a,{href:"https://serverfault.com/a/967483",children:"EC2 instances of different Security Groups to communicate through private IP"})]})}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"route_53_zone_id"})," is the AWS Route 53 hosted Zone ID that hosts the domain ",(0,s.jsx)(i.code,{children:"mywebservice.mycompany.com"})]}),"\n",(0,s.jsxs)(i.admonition,{type:"tip",children:[(0,s.jsx)(i.p,{children:"To find the zone ID in AWS Route 53, we can:"}),(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"Sign in to the AWS Management Console"}),"\n",(0,s.jsxs)(i.li,{children:["Open the Route 53 console at ",(0,s.jsx)(i.a,{href:"https://console.aws.amazon.com/route53/",children:"https://console.aws.amazon.com/route53/"})]}),"\n",(0,s.jsx)(i.li,{children:"Select Hosted zones in the navigation pane"}),"\n",(0,s.jsx)(i.li,{children:"Find the requested ID in the top level Hosted Zones summary in the Route 53 section"}),"\n"]})]}),"\n"]}),"\n"]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"building-ami-image",children:"Building AMI Image"}),"\n",(0,s.jsxs)(t.Z,{children:[(0,s.jsx)(r.Z,{value:"non-ssl",label:"non-SSL/HTTPS",default:!0,children:(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-console",children:'cd hashicorp-aws/hashicorp/webservice/images/basic\npacker init .\npacker validate -var "skip_create_ami=true" .\npacker build -var "skip_create_ami=false" .\n'})})}),(0,s.jsx)(r.Z,{value:"ssl",label:"SSL/HTTPS",children:(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-console",children:'cd hashicorp-aws/hashicorp/webservice/images/ssl\npacker init .\npacker validate -var "skip_create_ami=true" .\npacker build -var "skip_create_ami=false" .\n'})})})]}),"\n",(0,s.jsx)(i.h3,{id:"deploying-to-ec2",children:"Deploying to EC2"}),"\n",(0,s.jsx)(i.admonition,{type:"caution",children:(0,s.jsxs)(i.p,{children:["Depending on the ",(0,s.jsx)(i.a,{href:"#defining-packer-variables",children:"AMI"})," and ",(0,s.jsx)(i.a,{href:"#defining-terraform-variables",children:"EC2"})," configs, ",(0,s.jsx)(i.strong,{children:"please be aware\nAWS credit charges shall incur after the following commands execute"})]})}),"\n",(0,s.jsxs)(t.Z,{children:[(0,s.jsx)(r.Z,{value:"non-ssl",label:"non-SSL/HTTPS",default:!0,children:(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-console",children:"cd ../instances/basic\nterraform init\nterraform validate\nterraform apply -auto-approve\n"})})}),(0,s.jsx)(r.Z,{value:"ssl",label:"SSL/HTTPS",children:(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-console",children:"cd ../instances/ssl\nterraform init\nterraform validate\nterraform apply -auto-approve\n"})})})]}),"\n",(0,s.jsx)(i.h2,{id:"deployment-via-screwdriver-cd",children:"Deployment via Screwdriver CD"}),"\n",(0,s.jsxs)(i.p,{children:["hashicorp-aws supports deployment using ",(0,s.jsx)(i.a,{href:"screwdriver-cd-deployment",children:"Screwdriver CD"}),". Please check it out. ",(0,s.jsx)("img",{src:"https://github.com/QubitPi/QubitPi/blob/master/img/8%E5%A5%BD.gif?raw=true",height:"40px"})]}),"\n",(0,s.jsx)(i.h2,{id:"deployment-via-github-actions",children:"Deployment via GitHub Actions"}),"\n",(0,s.jsxs)(i.p,{children:["hashicorp-aws also supports deployment using ",(0,s.jsx)(i.a,{href:"github-actions",children:"GitHub Actions"})]}),"\n",(0,s.jsx)(i.h2,{id:"deployment-via-hacp",children:"Deployment via HACP"}),"\n",(0,s.jsx)(i.admonition,{type:"tip",children:(0,s.jsx)(i.p,{children:"Please try our HACP platform to deploy a Webservice instance. It gives us one-click experience that helps us stand up\na webservice in a minute."})}),"\n",(0,s.jsx)(i.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(i.h3,{id:"aws",children:"AWS"}),"\n",(0,s.jsx)(i.h4,{id:"the-webservice-was-running-properly-right-after-deployment-but-not-after-a-while-with-503-service-unavailable",children:'The Webservice was Running Properly Right After Deployment, but NOT After a While with "503 Service Unavailable"'}),"\n",(0,s.jsxs)(i.p,{children:["This could be the resource starvation on EC2 instance. Please try using a bigger EC2 sizes. For example, bumping\n",(0,s.jsx)(i.em,{children:"t2.micro"})," to ",(0,s.jsx)(i.em,{children:"t2.medium"}),". hashicorp-aws currently supports ",(0,s.jsx)(i.strong,{children:"t2.x"})," sizes, i.e. one of the following sizes can be\nselected:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"t2.micro"}),"\n",(0,s.jsx)(i.li,{children:"t2.small"}),"\n",(0,s.jsx)(i.li,{children:"t2.medium"}),"\n",(0,s.jsx)(i.li,{children:"t2.large"}),"\n",(0,s.jsx)(i.li,{children:"t2.xlarge"}),"\n",(0,s.jsx)(i.li,{children:"t2.2xlarge"}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["To modify the size, set the value of ",(0,s.jsx)(i.code,{children:"instance_type"})," in both ",(0,s.jsx)(i.em,{children:"aws-ws.pkrvars.hcl"})," and ",(0,s.jsx)(i.em,{children:"aws-ws.tfvars"}),". For\nexample:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-hcl",children:'instance_type       = "t2.medium"\n'})})]})}function p(e={}){const{wrapper:i}={...(0,a.a)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},79:(e,i,n)=>{n.d(i,{Z:()=>r});n(1733);var s=n(8490);const a={tabItem:"tabItem_udD9"};var t=n(3860);function r(e){let{children:i,hidden:n,className:r}=e;return(0,t.jsx)("div",{role:"tabpanel",className:(0,s.Z)(a.tabItem,r),hidden:n,children:i})}},6298:(e,i,n)=>{n.d(i,{Z:()=>y});var s=n(1733),a=n(8490),t=n(2533),r=n(850),l=n(2504),o=n(312),c=n(4274),h=n(9109);function d(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:i}=e;return!!i&&"object"==typeof i&&"value"in i}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:i,children:n}=e;return(0,s.useMemo)((()=>{const e=i??function(e){return d(e).map((e=>{let{props:{value:i,label:n,attributes:s,default:a}}=e;return{value:i,label:n,attributes:s,default:a}}))}(n);return function(e){const i=(0,c.l)(e,((e,i)=>e.value===i.value));if(i.length>0)throw new Error(`Docusaurus error: Duplicate values "${i.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[i,n])}function p(e){let{value:i,tabValues:n}=e;return n.some((e=>e.value===i))}function m(e){let{queryString:i=!1,groupId:n}=e;const a=(0,r.k6)(),t=function(e){let{queryString:i=!1,groupId:n}=e;if("string"==typeof i)return i;if(!1===i)return null;if(!0===i&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:i,groupId:n});return[(0,o._X)(t),(0,s.useCallback)((e=>{if(!t)return;const i=new URLSearchParams(a.location.search);i.set(t,e),a.replace({...a.location,search:i.toString()})}),[t,a])]}function b(e){const{defaultValue:i,queryString:n=!1,groupId:a}=e,t=u(e),[r,o]=(0,s.useState)((()=>function(e){let{defaultValue:i,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(i){if(!p({value:i,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${i}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return i}const s=n.find((e=>e.default))??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:i,tabValues:t}))),[c,d]=m({queryString:n,groupId:a}),[b,g]=function(e){let{groupId:i}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(i),[a,t]=(0,h.Nk)(n);return[a,(0,s.useCallback)((e=>{n&&t.set(e)}),[n,t])]}({groupId:a}),x=(()=>{const e=c??b;return p({value:e,tabValues:t})?e:null})();(0,l.Z)((()=>{x&&o(x)}),[x]);return{selectedValue:r,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:t}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),g(e)}),[d,g,t]),tabValues:t}}var g=n(5179);const x={tabList:"tabList_hqI3",tabItem:"tabItem_fHFm"};var v=n(3860);function f(e){let{className:i,block:n,selectedValue:s,selectValue:r,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,t.o5)(),h=e=>{const i=e.currentTarget,n=o.indexOf(i),a=l[n].value;a!==s&&(c(i),r(a))},d=e=>{let i=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const n=o.indexOf(e.currentTarget)+1;i=o[n]??o[0];break}case"ArrowLeft":{const n=o.indexOf(e.currentTarget)-1;i=o[n]??o[o.length-1];break}}i?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":n},i),children:l.map((e=>{let{value:i,label:n,attributes:t}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:s===i?0:-1,"aria-selected":s===i,ref:e=>o.push(e),onKeyDown:d,onClick:h,...t,className:(0,a.Z)("tabs__item",x.tabItem,t?.className,{"tabs__item--active":s===i}),children:n??i},i)}))})}function j(e){let{lazy:i,children:n,selectedValue:a}=e;const t=(Array.isArray(n)?n:[n]).filter(Boolean);if(i){const e=t.find((e=>e.props.value===a));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:t.map(((e,i)=>(0,s.cloneElement)(e,{key:i,hidden:e.props.value!==a})))})}function w(e){const i=b(e);return(0,v.jsxs)("div",{className:(0,a.Z)("tabs-container",x.tabList),children:[(0,v.jsx)(f,{...e,...i}),(0,v.jsx)(j,{...e,...i})]})}function y(e){const i=(0,g.Z)();return(0,v.jsx)(w,{...e,children:d(e.children)},String(i))}},5639:(e,i,n)=>{n.d(i,{Z:()=>l,a:()=>r});var s=n(1733);const a={},t=s.createContext(a);function r(e){const i=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(t.Provider,{value:i},e.children)}}}]);